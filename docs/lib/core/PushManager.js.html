<!DOCTYPE html>
<html>
<head>
  <title>PushManager.js</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <link rel="stylesheet" media="all" href="../../doc-style.css" />
  <script src="../../doc-filelist.js"></script>
  <script>
    var relativeDir = "../../", thisFile = "lib/core/PushManager.js", defaultSidebar = true;
  </script>
  <script src="../../doc-script.js"></script>
</head>
<body>
  <div id="sidebar_wrapper">
    <div id="sidebar_switch">
      <span class="tree">Files</span>
      <span class="headings">Headings</span>
    </div>
    <div id="tree"></div>
    <div id="headings">
      <div class="heading h1">
        <a href="#pushmanager">PushManager</a>
      </div>
      <div class="heading h2">
        <a href="#global%20scope">Global scope</a>
      </div>
      <div class="heading h2">
        <a href="#pushmanager%20constructor">PushManager constructor</a>
      </div>
      <div class="heading h3">
        <a href="#pushmanager.node">PushManager.node</a>
      </div>
      <div class="heading h3">
        <a href="#pushmanager.timer">PushManager.timer</a>
      </div>
      <div class="heading h3">
        <a href="#pushmanager.offsetwaittime">PushManager.offsetWaitTime</a>
      </div>
      <div class="heading h3">
        <a href="#pushmanager.replywaittime">PushManager.replyWaitTime</a>
      </div>
      <div class="heading h3">
        <a href="#pushmanager.checkpushwaittime">PushManager.checkPushWaitTime</a>
      </div>
      <div class="heading h3">
        <a href="#pushmanager.init">PushManager.init</a>
      </div>
      <div class="heading h2">
        <a href="#pushmanager.starttimer">PushManager.startTimer</a>
      </div>
      <div class="heading h2">
        <a href="#pushmanager.cleartimer">PushManager.clearTimer</a>
      </div>
      <div class="heading h2">
        <a href="#pushmanager.isactive">PushManager.isActive</a>
      </div>
      <div class="heading h3">
        <a href="#pushmanager.pushgame">PushManager.pushGame</a>
      </div>
      <div class="heading h2">
        <a href="#helper%20methods">Helper methods</a>
      </div>
      <div class="heading h3">
        <a href="#checkifpushworked">checkIfPushWorked</a>
      </div>
      <div class="heading h3">
        <a href="#forcedisconnect">forceDisconnect</a>
      </div>
      <div class="heading h3">
        <a href="#checkandassignwaittime">checkAndAssignWaitTime</a>
      </div>
      <div class="heading h3">
        <a href="#checkandassignallwaittimes">checkAndAssignAllWaitTimes</a>
      </div>
    </div>
  </div>
  <div id="sidebar-toggle"></div>
  <div id="container"><div class="background highlight"></div>
<table cellpadding="0" cellspacing="0">
  <tbody>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="pushmanager">
  <h1>
    <a href="#pushmanager" name="pushmanager" class="pilcrow">&#182;</a>
    PushManager
  </h1>
</div>

  </div>
  <div class="body"><p>Push players to advance to next step, otherwise disconnects them.</p>

<p>Copyright(c) 2016 Stefano Balietti
MIT Licensed</p>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">exports</span><span class="p">,</span> <span class="nx">parent</span><span class="p">)</span> <span class="p">{</span>

    <span class="s2">&quot;use strict&quot;</span><span class="p">;</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap" id="global%20scope">
  <h2>
    <a href="#global%20scope" name="global%20scope" class="pilcrow">&#182;</a>
    Global scope
  </h2>
</div>

        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="nx">exports</span><span class="p">.</span><span class="nx">PushManager</span> <span class="o">=</span> <span class="nx">PushManager</span><span class="p">;</span>

    <span class="kd">var</span> <span class="nx">GameStage</span> <span class="o">=</span> <span class="nx">parent</span><span class="p">.</span><span class="nx">GameStage</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">J</span> <span class="o">=</span> <span class="nx">parent</span><span class="p">.</span><span class="nx">JSUS</span><span class="p">;</span>

    <span class="kd">var</span> <span class="nx">DONE</span> <span class="o">=</span> <span class="nx">parent</span><span class="p">.</span><span class="nx">constants</span><span class="p">.</span><span class="nx">stageLevels</span><span class="p">.</span><span class="nx">DONE</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">PUSH_STEP</span> <span class="o">=</span> <span class="nx">parent</span><span class="p">.</span><span class="nx">constants</span><span class="p">.</span><span class="nx">gamecommands</span><span class="p">.</span><span class="nx">push_step</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">GAMECOMMAND</span> <span class="o">=</span> <span class="nx">parent</span><span class="p">.</span><span class="nx">constants</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">GAMECOMMAND</span><span class="p">;</span>

    <span class="nx">PushManager</span><span class="p">.</span><span class="nx">offsetWaitTime</span> <span class="o">=</span> <span class="mi">5000</span><span class="p">;</span>
    <span class="nx">PushManager</span><span class="p">.</span><span class="nx">replyWaitTime</span> <span class="o">=</span> <span class="mi">2000</span><span class="p">;</span>
    <span class="nx">PushManager</span><span class="p">.</span><span class="nx">checkPushWaitTime</span> <span class="o">=</span> <span class="mi">2000</span><span class="p">;</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="pushmanager%20constructor">
  <h2>
    <a href="#pushmanager%20constructor" name="pushmanager%20constructor" class="pilcrow">&#182;</a>
    PushManager constructor
  </h2>
</div>

  </div>
  <div class="body"><p>Creates a new instance of PushManager</p>
  </div>
  <div class="details">
    <div class="dox_tag_title">Params</div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">node</span>
      <span class="dox_type">NodeGameClient</span>
      <span>A nodegame-client instance</span>
    </div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">options</span>
      <span class="dox_type">object</span>
      <span>Optional. Configuration options</span>
    </div>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">function</span> <span class="nx">PushManager</span><span class="p">(</span><span class="nx">node</span><span class="p">,</span> <span class="nx">options</span><span class="p">)</span> <span class="p">{</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="pushmanager.node">
  <h3>
    <a href="#pushmanager.node" name="pushmanager.node" class="pilcrow">&#182;</a>
    PushManager.node
  </h3>
</div>

  </div>
  <div class="body"><p>Reference to a nodegame-client instance</p>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="k">this</span><span class="p">.</span><span class="nx">node</span> <span class="o">=</span> <span class="nx">node</span><span class="p">;</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="pushmanager.timer">
  <h3>
    <a href="#pushmanager.timer" name="pushmanager.timer" class="pilcrow">&#182;</a>
    PushManager.timer
  </h3>
</div>

  </div>
  <div class="body"><p>The timer object that will fire the checking of clients</p>

<p>The timer will be created only if needed.</p>
  </div>
  <div class="details">
    <div class="dox_tag_title">See</div>
    <div class="dox_tag_detail">
      <span class="dox_type">PushManager.startTimer
</span>
    </div>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="k">this</span><span class="p">.</span><span class="nx">timer</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="pushmanager.offsetwaittime">
  <h3>
    <a href="#pushmanager.offsetwaittime" name="pushmanager.offsetwaittime" class="pilcrow">&#182;</a>
    PushManager.offsetWaitTime
  </h3>
</div>

  </div>
  <div class="body"><p>Time that is always added to the timer value of</p>
  </div>
  <div class="details">
    <div class="dox_tag_title">See</div>
    <div class="dox_tag_detail">
      <span class="dox_type">PushManager.startTimer
</span>
    </div>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="k">this</span><span class="p">.</span><span class="nx">offsetWaitTime</span> <span class="o">=</span> <span class="nx">PushManager</span><span class="p">.</span><span class="nx">offsetWaitTime</span><span class="p">;</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="pushmanager.replywaittime">
  <h3>
    <a href="#pushmanager.replywaittime" name="pushmanager.replywaittime" class="pilcrow">&#182;</a>
    PushManager.replyWaitTime
  </h3>
</div>

  </div>
  <div class="body"><p>Time to wait to get a reply from a pushed client</p>
  </div>
  <div class="details">
    <div class="dox_tag_title">See</div>
    <div class="dox_tag_detail">
      <span class="dox_type">PushManager.pushGame
</span>
    </div>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="k">this</span><span class="p">.</span><span class="nx">replyWaitTime</span> <span class="o">=</span> <span class="nx">PushManager</span><span class="p">.</span><span class="nx">replyWaitTime</span><span class="p">;</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="pushmanager.checkpushwaittime">
  <h3>
    <a href="#pushmanager.checkpushwaittime" name="pushmanager.checkpushwaittime" class="pilcrow">&#182;</a>
    PushManager.checkPushWaitTime
  </h3>
</div>

  </div>
  <div class="body"><p>Time to wait to check if a pushed client updated its state</p>
  </div>
  <div class="details">
    <div class="dox_tag_title">See</div>
    <div class="dox_tag_detail">
      <span class="dox_type">PushManager.pushGame
</span>
    </div>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="k">this</span><span class="p">.</span><span class="nx">checkPushWaitTime</span> <span class="o">=</span> <span class="nx">PushManager</span><span class="p">.</span><span class="nx">checkPushWaitTime</span><span class="p">;</span>

        <span class="k">this</span><span class="p">.</span><span class="nx">init</span><span class="p">(</span><span class="nx">options</span><span class="p">);</span>
    <span class="p">}</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="pushmanager.init">
  <h3>
    <a href="#pushmanager.init" name="pushmanager.init" class="pilcrow">&#182;</a>
    PushManager.init
  </h3>
</div>

  </div>
  <div class="body"><p>Inits the configuration for the instance</p>
  </div>
  <div class="details">
    <div class="dox_tag_title">Params</div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">Optional.</span>
      <span class="dox_type">object</span>
      <span>Configuration object</span>
    </div>
    <div class="dox_tag_title">See</div>
    <div class="dox_tag_detail">
      <span class="dox_type">checkAndAssignAllWaitTimes
</span>
    </div>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="nx">PushManager</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">init</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">options</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">options</span> <span class="o">=</span> <span class="nx">options</span> <span class="o">||</span> <span class="p">{};</span>
        <span class="nx">checkAndAssignAllWaitTimes</span><span class="p">(</span><span class="s1">&#39;init&#39;</span><span class="p">,</span> <span class="nx">options</span><span class="p">,</span> <span class="k">this</span><span class="p">);</span>
    <span class="p">};</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="pushmanager.starttimer">
  <h2>
    <a href="#pushmanager.starttimer" name="pushmanager.starttimer" class="pilcrow">&#182;</a>
    PushManager.startTimer
  </h2>
</div>

  </div>
  <div class="body"><p>Sets a timer for checking if all clients have finished current step</p>

<p>The duration of the timer is specified by parameter  conf.offset.
(Default this.offsetWaitTime). Other options in configuration
parameter are passed to <code>PushManager.pushGame</code>, which is called
if timer expires.</p>

<p>Calling startTimer on a running timer will clear previous one,
and create a new one.</p>
  </div>
  <div class="details">
    <div class="dox_tag_title">Params</div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">conf</span>
      <span class="dox_type">boolean</span>
      <span class="dox_type">object</span>
      <span>Optional. Configuration object passed
   to <code>pushGame</code> method.</span>
    </div>
    <div class="dox_tag_title">See</div>
    <div class="dox_tag_detail">
      <span class="dox_type">PushManager.offsetWaitTime</span>
    </div>
    <div class="dox_tag_title">See</div>
    <div class="dox_tag_detail">
      <span class="dox_type">PushManager.pushGame</span>
    </div>
    <div class="dox_tag_title">See</div>
    <div class="dox_tag_detail">
      <span class="dox_type">GameTimer.parseMilliseconds
</span>
    </div>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="nx">PushManager</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">startTimer</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">conf</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">stage</span><span class="p">,</span> <span class="nx">pushCb</span><span class="p">,</span> <span class="nx">that</span><span class="p">,</span> <span class="nx">offset</span><span class="p">;</span>
        <span class="kd">var</span> <span class="nx">node</span><span class="p">;</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-11" id="section-11">&#182;</a>
</div>
<p>Adjust user input.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="k">if</span> <span class="p">(</span><span class="nx">conf</span> <span class="o">===</span> <span class="kc">true</span> <span class="o">||</span> <span class="s1">&#39;undefined&#39;</span> <span class="o">===</span> <span class="k">typeof</span> <span class="nx">conf</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">conf</span> <span class="o">=</span> <span class="p">{};</span>
        <span class="p">}</span>
        <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;object&#39;</span> <span class="o">!==</span> <span class="k">typeof</span> <span class="nx">conf</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nx">TypError</span><span class="p">(</span><span class="s1">&#39;PushManager.startTimer: conf must be &#39;</span> <span class="o">+</span>
                               <span class="s1">&#39;object, TRUE, or undefined. Found: &#39;</span> <span class="o">+</span> <span class="nx">conf</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;PUSH.TIMER ************************* &#39;</span><span class="p">,</span> <span class="nx">conf</span><span class="p">);</span>

        <span class="nx">node</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">node</span><span class="p">;</span>

        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">timer</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">timer</span> <span class="o">=</span> <span class="nx">node</span><span class="p">.</span><span class="nx">timer</span><span class="p">.</span><span class="nx">createTimer</span><span class="p">({</span> <span class="nx">name</span><span class="o">:</span> <span class="s1">&#39;push_clients&#39;</span> <span class="p">});</span>
        <span class="p">}</span>
        <span class="k">else</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">clearTimer</span><span class="p">();</span>
        <span class="p">}</span>

        <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;undefined&#39;</span> <span class="o">!==</span> <span class="k">typeof</span> <span class="nx">conf</span><span class="p">.</span><span class="nx">offset</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">offset</span> <span class="o">=</span> <span class="nx">node</span><span class="p">.</span><span class="nx">timer</span><span class="p">.</span><span class="nx">parseInput</span><span class="p">(</span><span class="s1">&#39;offset&#39;</span><span class="p">,</span> <span class="nx">conf</span><span class="p">.</span><span class="nx">offset</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">else</span> <span class="p">{</span>
            <span class="nx">offset</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">offsetWaitTime</span><span class="p">;</span>
        <span class="p">}</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-12" id="section-12">&#182;</a>
</div>
<p>Cloning current stage.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="nx">stage</span> <span class="o">=</span> <span class="p">{</span>
            <span class="nx">stage</span><span class="o">:</span> <span class="nx">node</span><span class="p">.</span><span class="nx">player</span><span class="p">.</span><span class="nx">stage</span><span class="p">.</span><span class="nx">stage</span><span class="p">,</span>
            <span class="nx">step</span><span class="o">:</span> <span class="nx">node</span><span class="p">.</span><span class="nx">player</span><span class="p">.</span><span class="nx">stage</span><span class="p">.</span><span class="nx">step</span><span class="p">,</span>
            <span class="nx">round</span><span class="o">:</span> <span class="nx">node</span><span class="p">.</span><span class="nx">player</span><span class="p">.</span><span class="nx">stage</span><span class="p">.</span><span class="nx">round</span>
        <span class="p">};</span>

        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;push-manager: starting timer: &#39;</span> <span class="o">+</span> <span class="nx">offset</span> <span class="o">+</span> <span class="s1">&#39;, &#39;</span> <span class="o">+</span> <span class="nx">stage</span><span class="p">);</span>
        <span class="nx">node</span><span class="p">.</span><span class="nx">silly</span><span class="p">(</span><span class="s1">&#39;push-manager: starting timer: &#39;</span> <span class="o">+</span> <span class="nx">offset</span> <span class="o">+</span> <span class="s1">&#39;, &#39;</span> <span class="o">+</span> <span class="nx">stage</span><span class="p">);</span>

        <span class="nx">that</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>
        <span class="nx">pushCb</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span> <span class="nx">that</span><span class="p">.</span><span class="nx">pushGame</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">that</span><span class="p">,</span> <span class="nx">stage</span><span class="p">,</span> <span class="nx">conf</span><span class="p">);</span> <span class="p">};</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-13" id="section-13">&#182;</a>
</div>
<p>Make sure milliseconds and update are the same.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="k">this</span><span class="p">.</span><span class="nx">timer</span><span class="p">.</span><span class="nx">init</span><span class="p">({</span>
            <span class="nx">milliseconds</span><span class="o">:</span> <span class="nx">offset</span><span class="p">,</span>
            <span class="nx">update</span><span class="o">:</span> <span class="nx">offset</span><span class="p">,</span>
            <span class="nx">timeup</span><span class="o">:</span> <span class="nx">pushCb</span><span class="p">,</span>
        <span class="p">});</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">timer</span><span class="p">.</span><span class="nx">start</span><span class="p">();</span>
    <span class="p">};</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="pushmanager.cleartimer">
  <h2>
    <a href="#pushmanager.cleartimer" name="pushmanager.cleartimer" class="pilcrow">&#182;</a>
    PushManager.clearTimer
  </h2>
</div>

  </div>
  <div class="body"><p>Clears timer for checking if all clients have finished current step</p>
  </div>
  <div class="details">
    <div class="dox_tag_title">See</div>
    <div class="dox_tag_detail">
      <span class="dox_type">PushManager.startTimer
</span>
    </div>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="nx">PushManager</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">clearTimer</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">timer</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">timer</span><span class="p">.</span><span class="nx">isStopped</span><span class="p">())</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">node</span><span class="p">.</span><span class="nx">silly</span><span class="p">(</span><span class="s1">&#39;push-manager: timer cleared.&#39;</span><span class="p">);</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">timer</span><span class="p">.</span><span class="nx">stop</span><span class="p">();</span>
        <span class="p">}</span>
    <span class="p">};</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="pushmanager.isactive">
  <h2>
    <a href="#pushmanager.isactive" name="pushmanager.isactive" class="pilcrow">&#182;</a>
    PushManager.isActive
  </h2>
</div>

  </div>
  <div class="body"><p>Returns TRUE if timer is running</p>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="nx">PushManager</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">isActive</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">timer</span><span class="p">.</span><span class="nx">isStopped</span><span class="p">();</span>
    <span class="p">}</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="pushmanager.pushgame">
  <h3>
    <a href="#pushmanager.pushgame" name="pushmanager.pushgame" class="pilcrow">&#182;</a>
    PushManager.pushGame
  </h3>
</div>

  </div>
  <div class="body"><p>Pushes any client that is connected, but not DONE, to step forward</p>

<p>It sends a GET message to all clients whose stage level is not
marked as DONE (100), and waits for the reply. If the reply does
not arrive it will disconnect them. If the reply arrives, it will
later check if they manage to step, and if not disconnects them.</p>
  </div>
  <div class="details">
    <div class="dox_tag_title">Params</div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">stage</span>
      <span class="dox_type">object</span>
      <span>The stage to check</span>
    </div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">conf</span>
      <span class="dox_type">object</span>
      <span>Optional. Configuration options.</span>
    </div>
    <div class="dox_tag_title">See</div>
    <div class="dox_tag_detail">
      <span class="dox_type">checkIfPushWorked
</span>
    </div>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="nx">PushManager</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">pushGame</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">stage</span><span class="p">,</span> <span class="nx">conf</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">m</span><span class="p">,</span> <span class="nx">node</span><span class="p">,</span> <span class="nx">replyWaitTime</span><span class="p">,</span> <span class="nx">checkPushWaitTime</span><span class="p">;</span>
        <span class="nx">node</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">node</span><span class="p">;</span>

        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;checking clients&#39;</span><span class="p">);</span>
        <span class="nx">node</span><span class="p">.</span><span class="nx">silly</span><span class="p">(</span><span class="s1">&#39;push-manager: checking clients.&#39;</span><span class="p">);</span>

        <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;object&#39;</span> <span class="o">===</span> <span class="k">typeof</span> <span class="nx">conf</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">m</span> <span class="o">=</span> <span class="s1">&#39;pushGame&#39;</span><span class="p">;</span>
            <span class="nx">replyWaitTime</span> <span class="o">=</span> <span class="nx">checkAndAssignWaitTime</span><span class="p">(</span><span class="nx">m</span><span class="p">,</span> <span class="nx">conf</span><span class="p">,</span> <span class="s1">&#39;reply&#39;</span><span class="p">,</span> <span class="nx">conf</span><span class="p">);</span>
            <span class="nx">checkPushWaitTime</span> <span class="o">=</span> <span class="nx">checkAndAssignWaitTime</span><span class="p">(</span><span class="nx">m</span><span class="p">,</span> <span class="nx">conf</span><span class="p">,</span> <span class="s1">&#39;check&#39;</span><span class="p">,</span> <span class="nx">conf</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;undefined&#39;</span> <span class="o">===</span> <span class="k">typeof</span> <span class="nx">replyWaitTime</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">replyWaitTime</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">replyWaitTime</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;undefined&#39;</span> <span class="o">===</span> <span class="k">typeof</span> <span class="nx">checkPushWaitTime</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">checkPushWaitTime</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">checkPushWaitTime</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="nx">node</span><span class="p">.</span><span class="nx">game</span><span class="p">.</span><span class="nx">pl</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">p</span><span class="p">)</span> <span class="p">{</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-17" id="section-17">&#182;</a>
</div>
<p>A client is not DONE and it is still in the same stage level.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
            <span class="k">if</span> <span class="p">(</span><span class="nx">p</span><span class="p">.</span><span class="nx">stageLevel</span> <span class="o">!==</span> <span class="nx">DONE</span> <span class="o">&amp;&amp;</span>
                <span class="nx">GameStage</span><span class="p">.</span><span class="nx">compare</span><span class="p">(</span><span class="nx">p</span><span class="p">.</span><span class="nx">stage</span><span class="p">,</span> <span class="nx">stage</span><span class="p">)</span> <span class="o">===</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>

                <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;push needed&#39;</span><span class="p">);</span>
                <span class="nx">node</span><span class="p">.</span><span class="nx">warn</span><span class="p">(</span><span class="s1">&#39;push needed: &#39;</span> <span class="o">+</span> <span class="nx">p</span><span class="p">.</span><span class="nx">id</span><span class="p">);</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-18" id="section-18">&#182;</a>
</div>
<p>Send push.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
                <span class="nx">node</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">PUSH_STEP</span><span class="p">,</span>
                         <span class="kd">function</span><span class="p">(</span><span class="nx">value</span><span class="p">)</span> <span class="p">{</span>
                             <span class="nx">checkIfPushWorked</span><span class="p">(</span><span class="nx">node</span><span class="p">,</span> <span class="nx">p</span><span class="p">,</span> <span class="nx">stage</span><span class="p">,</span>
                                               <span class="nx">checkPushWaitTime</span><span class="p">);</span>
                         <span class="p">},</span>
                         <span class="nx">p</span><span class="p">.</span><span class="nx">id</span><span class="p">,</span> <span class="p">{</span>
                             <span class="nx">timeout</span><span class="o">:</span> <span class="nx">replyWaitTime</span><span class="p">,</span>
                             <span class="nx">executeOnce</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
                             <span class="nx">target</span><span class="o">:</span> <span class="nx">GAMECOMMAND</span><span class="p">,</span>
                             <span class="nx">timeoutCb</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
                                 <span class="nx">forceDisconnect</span><span class="p">(</span><span class="nx">node</span><span class="p">,</span> <span class="nx">p</span><span class="p">);</span>
                             <span class="p">}</span>
                         <span class="p">});</span>
            <span class="p">}</span>
        <span class="p">});</span>
    <span class="p">};</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap" id="helper%20methods">
  <h2>
    <a href="#helper%20methods" name="helper%20methods" class="pilcrow">&#182;</a>
    Helper methods
  </h2>
</div>

        </td>
        <td class="code highlight"><div class="highlight"><pre>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="checkifpushworked">
  <h3>
    <a href="#checkifpushworked" name="checkifpushworked" class="pilcrow">&#182;</a>
    checkIfPushWorked
  </h3>
</div>

  </div>
  <div class="body"><p>Checks whether the stage of a client has changed after</p>
  </div>
  <div class="details">
    <div class="dox_tag_title">Params</div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">node</span>
      <span class="dox_type">NodeGameClient</span>
      <span>The node instance used to send msg</span>
    </div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">p</span>
      <span class="dox_type">object</span>
      <span>The player object containing info about id and sid</span>
    </div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">stage</span>
      <span class="dox_type">GameStage</span>
      <span>The stage to check</span>
    </div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">milliseconds</span>
      <span class="dox_type">number</span>
      <span>Optional The number of milliseconds to
  wait before checking again the stage of a client. Default 0.</span>
    </div>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">function</span> <span class="nx">checkIfPushWorked</span><span class="p">(</span><span class="nx">node</span><span class="p">,</span> <span class="nx">p</span><span class="p">,</span> <span class="nx">stage</span><span class="p">,</span> <span class="nx">milliseconds</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">stage</span><span class="p">;</span>

        <span class="nx">node</span><span class="p">.</span><span class="nx">info</span><span class="p">(</span><span class="s1">&#39;push-manager: received reply from &#39;</span> <span class="o">+</span> <span class="nx">p</span><span class="p">.</span><span class="nx">id</span><span class="p">);</span>

        <span class="nx">setTimeout</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">pp</span><span class="p">;</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">node</span><span class="p">.</span><span class="nx">game</span><span class="p">.</span><span class="nx">pl</span><span class="p">.</span><span class="nx">exist</span><span class="p">(</span><span class="nx">p</span><span class="p">.</span><span class="nx">id</span><span class="p">))</span> <span class="p">{</span>
                <span class="nx">pp</span> <span class="o">=</span> <span class="nx">node</span><span class="p">.</span><span class="nx">game</span><span class="p">.</span><span class="nx">pl</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">p</span><span class="p">.</span><span class="nx">id</span><span class="p">);</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-21" id="section-21">&#182;</a>
</div>
<p>Client could have moved to next step, or be DONE
waiting for a command from server.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
                <span class="k">if</span> <span class="p">(</span><span class="nx">GameStage</span><span class="p">.</span><span class="nx">compare</span><span class="p">(</span><span class="nx">pp</span><span class="p">.</span><span class="nx">stage</span><span class="p">,</span> <span class="nx">stage</span><span class="p">)</span> <span class="o">!==</span> <span class="mi">0</span> <span class="o">||</span>
                    <span class="nx">pp</span><span class="p">.</span><span class="nx">stageLevel</span> <span class="o">===</span> <span class="nx">DONE</span><span class="p">)</span> <span class="p">{</span>

                    <span class="nx">node</span><span class="p">.</span><span class="nx">info</span><span class="p">(</span><span class="s1">&#39;push-manager: push worked for &#39;</span> <span class="o">+</span> <span class="nx">p</span><span class="p">.</span><span class="nx">id</span><span class="p">);</span>
                <span class="p">}</span>
                <span class="k">else</span> <span class="p">{</span>
                    <span class="nx">forceDisconnect</span><span class="p">(</span><span class="nx">node</span><span class="p">,</span> <span class="nx">pp</span><span class="p">);</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">},</span> <span class="nx">milliseconds</span> <span class="o">||</span> <span class="mi">0</span><span class="p">);</span>
    <span class="p">}</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="forcedisconnect">
  <h3>
    <a href="#forcedisconnect" name="forcedisconnect" class="pilcrow">&#182;</a>
    forceDisconnect
  </h3>
</div>

  </div>
  <div class="body"><p>Disconnects one player by sending a DISCONNECT msg to server</p>
  </div>
  <div class="details">
    <div class="dox_tag_title">Params</div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">node</span>
      <span class="dox_type">NodeGameClient</span>
      <span>The node instance used to send msg</span>
    </div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">p</span>
      <span class="dox_type">object</span>
      <span>The player object containing info about id and sid</span>
    </div>
  </div>
</div>


<div class="highlight"><pre><code><span class="kd">function</span> <span class="nx">forceDisconnect</span><span class="p">(</span><span class="nx">node</span><span class="p">,</span> <span class="nx">p</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// No reply to GET, disconnect client.</span>
    <span class="nx">node</span><span class="p">.</span><span class="nx">warn</span><span class="p">(</span><span class="s1">&#39;push-manager: disconnecting: &#39;</span> <span class="o">+</span> <span class="nx">p</span><span class="p">.</span><span class="nx">id</span><span class="p">);</span>
    <span class="nx">node</span><span class="p">.</span><span class="nx">disconnectClient</span><span class="p">(</span><span class="nx">p</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>


        </td>
        <td class="code highlight"><div class="highlight"><pre>

    <span class="kd">function</span> <span class="nx">forceDisconnect</span><span class="p">(</span><span class="nx">node</span><span class="p">,</span> <span class="nx">p</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">msg</span><span class="p">;</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-23" id="section-23">&#182;</a>
</div>
<p>No reply to GET, disconnect client.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="nx">node</span><span class="p">.</span><span class="nx">warn</span><span class="p">(</span><span class="s1">&#39;push-manager: disconnecting: &#39;</span> <span class="o">+</span> <span class="nx">p</span><span class="p">.</span><span class="nx">id</span><span class="p">);</span>

        <span class="nx">msg</span> <span class="o">=</span> <span class="nx">node</span><span class="p">.</span><span class="nx">msg</span><span class="p">.</span><span class="nx">create</span><span class="p">({</span>
            <span class="nx">target</span><span class="o">:</span> <span class="s1">&#39;SERVERCOMMAND&#39;</span><span class="p">,</span>
            <span class="nx">text</span><span class="o">:</span> <span class="s1">&#39;DISCONNECT&#39;</span><span class="p">,</span>
            <span class="nx">data</span><span class="o">:</span> <span class="p">{</span>
                <span class="nx">id</span><span class="o">:</span> <span class="nx">p</span><span class="p">.</span><span class="nx">id</span><span class="p">,</span>
                <span class="nx">sid</span><span class="o">:</span> <span class="nx">p</span><span class="p">.</span><span class="nx">sid</span>
            <span class="p">}</span>
        <span class="p">});</span>
        <span class="nx">node</span><span class="p">.</span><span class="nx">socket</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="nx">msg</span><span class="p">);</span>
    <span class="p">}</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="checkandassignwaittime">
  <h3>
    <a href="#checkandassignwaittime" name="checkandassignwaittime" class="pilcrow">&#182;</a>
    checkAndAssignWaitTime
  </h3>
</div>

  </div>
  <div class="body"><p>Checks if a valid wait time is found in options object, if so assigns it</p>

<p>Option name is first tried as it is, and if not found, 'WaitTime'
is appended, and check if performed again.</p>

<p>If set, properties must be positive numbers, otherwise an error is
thrown.</p>
  </div>
  <div class="details">
    <div class="dox_tag_title">Params</div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">method</span>
      <span class="dox_type">string</span>
      <span>Then name of the method invoking the function</span>
    </div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">options</span>
      <span class="dox_type">object</span>
      <span>Configuration options</span>
    </div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">name</span>
      <span class="dox_type">string</span>
      <span>The name of the option to check and assign.
   If the option is not defined, it appends 'WaitTime', and tries again.</span>
    </div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">that</span>
      <span class="dox_type">object</span>
      <span>The instance to which assign the correct value</span>
    </div>
    <div class="dox_tag_title">Returns</div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name"></span>
      <span class="dox_type">number</span>
      <span>The validated number, or undefined if not set</span>
    </div>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">function</span> <span class="nx">checkAndAssignWaitTime</span><span class="p">(</span><span class="nx">method</span><span class="p">,</span> <span class="nx">options</span><span class="p">,</span> <span class="nx">name</span><span class="p">,</span> <span class="nx">that</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">n</span><span class="p">;</span>
        <span class="nx">n</span> <span class="o">=</span> <span class="nx">options</span><span class="p">[</span><span class="nx">name</span><span class="p">];</span>
        <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;undefined&#39;</span> <span class="o">!==</span> <span class="k">typeof</span> <span class="nx">n</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">name</span> <span class="o">=</span> <span class="nx">name</span> <span class="o">+</span> <span class="s1">&#39;WaitTime&#39;</span><span class="p">;</span>
            <span class="nx">n</span> <span class="o">=</span> <span class="nx">options</span><span class="p">[</span><span class="nx">name</span><span class="p">];</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;undefined&#39;</span> <span class="o">!==</span> <span class="k">typeof</span> <span class="nx">n</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;number&#39;</span> <span class="o">!==</span> <span class="k">typeof</span> <span class="nx">n</span> <span class="o">||</span> <span class="nx">n</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">throw</span> <span class="k">new</span> <span class="nx">TypeError</span><span class="p">(</span><span class="s1">&#39;PushManager.&#39;</span> <span class="o">+</span> <span class="nx">method</span> <span class="o">+</span> <span class="s1">&#39;: options.&#39;</span> <span class="o">+</span>
                                    <span class="nx">name</span> <span class="o">+</span> <span class="s1">&#39;must be a positive number. &#39;</span> <span class="o">+</span>
                                    <span class="s1">&#39;Found: &#39;</span> <span class="o">+</span> <span class="nx">n</span><span class="p">);</span>
            <span class="p">}</span>
            <span class="nx">that</span><span class="p">[</span><span class="nx">name</span><span class="p">]</span> <span class="o">=</span> <span class="nx">n</span><span class="p">;</span>
            <span class="k">return</span> <span class="nx">n</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="checkandassignallwaittimes">
  <h3>
    <a href="#checkandassignallwaittimes" name="checkandassignallwaittimes" class="pilcrow">&#182;</a>
    checkAndAssignAllWaitTimes
  </h3>
</div>

  </div>
  <div class="body"><p>Validates properties 'offset', 'reply', and 'check' of an object</p>
  </div>
  <div class="details">
    <div class="dox_tag_title">Params</div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">method</span>
      <span class="dox_type">string</span>
      <span>Then name of the method invoking the function</span>
    </div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">options</span>
      <span class="dox_type">object</span>
      <span>Configuration options</span>
    </div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">that</span>
      <span class="dox_type">object</span>
      <span>The instance to which assign the correct value</span>
    </div>
    <div class="dox_tag_title">See</div>
    <div class="dox_tag_detail">
      <span class="dox_type">PushManager.init</span>
    </div>
    <div class="dox_tag_title">See</div>
    <div class="dox_tag_detail">
      <span class="dox_type">checkAndAssignWaitTime
</span>
    </div>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">function</span> <span class="nx">checkAndAssignAllWaitTimes</span><span class="p">(</span><span class="nx">method</span><span class="p">,</span> <span class="nx">options</span><span class="p">,</span> <span class="nx">that</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">checkAndAssignWaitTime</span><span class="p">(</span><span class="nx">method</span><span class="p">,</span> <span class="nx">options</span><span class="p">,</span> <span class="s1">&#39;offset&#39;</span><span class="p">,</span> <span class="nx">that</span><span class="p">);</span>
        <span class="nx">checkAndAssignWaitTime</span><span class="p">(</span><span class="nx">method</span><span class="p">,</span> <span class="nx">options</span><span class="p">,</span> <span class="s1">&#39;reply&#39;</span><span class="p">,</span> <span class="nx">that</span><span class="p">);</span>
        <span class="nx">checkAndAssignWaitTime</span><span class="p">(</span><span class="nx">method</span><span class="p">,</span> <span class="nx">options</span><span class="p">,</span> <span class="s1">&#39;check&#39;</span><span class="p">,</span> <span class="nx">that</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">})(</span>
    <span class="s1">&#39;undefined&#39;</span> <span class="o">!==</span> <span class="k">typeof</span> <span class="nx">node</span> <span class="o">?</span> <span class="nx">node</span> <span class="o">:</span> <span class="nx">module</span><span class="p">.</span><span class="nx">exports</span><span class="p">,</span>
    <span class="s1">&#39;undefined&#39;</span> <span class="o">!==</span> <span class="k">typeof</span> <span class="nx">node</span> <span class="o">?</span> <span class="nx">node</span> <span class="o">:</span> <span class="nx">module</span><span class="p">.</span><span class="nx">parent</span><span class="p">.</span><span class="nx">exports</span>
<span class="p">);</span>
</pre></div>
        </td>
      </tr>
  </tbody>
</table>
  </div>
</body>
</html>
