<!DOCTYPE html>
<html>
<head>
  <title>Roler.js</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <link rel="stylesheet" media="all" href="../../doc-style.css" />
  <script src="../../doc-filelist.js"></script>
  <script>
    var relativeDir = "../../", thisFile = "lib/matcher/Roler.js", defaultSidebar = true;
  </script>
  <script src="../../doc-script.js"></script>
</head>
<body>
  <div id="sidebar_wrapper">
    <div id="sidebar_switch">
      <span class="tree">Files</span>
      <span class="headings">Headings</span>
    </div>
    <div id="tree"></div>
    <div id="headings">
      <div class="heading h1">
        <a href="#roler">Roler</a>
      </div>
      <div class="heading h2">
        <a href="#global%20scope">Global scope</a>
      </div>
      <div class="heading h2">
        <a href="#static%20methods.">Static methods.</a>
      </div>
      <div class="heading h3">
        <a href="#roler.linearrolifier">Roler.linearRolifier</a>
      </div>
      <div class="heading h2">
        <a href="#roler%20constructor">Roler constructor</a>
      </div>
      <div class="heading h3">
        <a href="#roler.roles">Roler.roles</a>
      </div>
      <div class="heading h3">
        <a href="#roler.rolesarray">Roler.rolesArray</a>
      </div>
      <div class="heading h3">
        <a href="#roler.rolifiedmatches">Roler.rolifiedMatches</a>
      </div>
      <div class="heading h3">
        <a href="#roler.role2idmatches">Roler.role2IdMatches</a>
      </div>
      <div class="heading h3">
        <a href="#roler.id2rolematches">Roler.id2RoleMatches</a>
      </div>
      <div class="heading h3">
        <a href="#roler.role2idroundmap">Roler.role2IdRoundMap</a>
      </div>
      <div class="heading h3">
        <a href="#roler.rolify">Roler.rolify</a>
      </div>
      <div class="heading h3">
        <a href="#roler.missingid">Roler.missingId</a>
      </div>
      <div class="heading h2">
        <a href="#init%2Fclear.">Init/clear.</a>
      </div>
      <div class="heading h3">
        <a href="#roler.init">Roler.init</a>
      </div>
      <div class="heading h3">
        <a href="#roler.clear">Roler.clear</a>
      </div>
      <div class="heading h2">
        <a href="#setters.">Setters.</a>
      </div>
      <div class="heading h3">
        <a href="#roler.setrolifycb">Roler.setRolifyCb</a>
      </div>
      <div class="heading h3">
        <a href="#roler.setroles">Roler.setRoles</a>
      </div>
      <div class="heading h3">
        <a href="#roler.setrolefor">Roler.setRoleFor</a>
      </div>
      <div class="heading h3">
        <a href="#roler.setrolifiedmatches">Roler.setRolifiedMatches</a>
      </div>
      <div class="heading h3">
        <a href="#roler.setrole2idmatches">Roler.setRole2IdMatches</a>
      </div>
      <div class="heading h3">
        <a href="#roler.setid2rolematches">Roler.setId2RoleMatches</a>
      </div>
      <div class="heading h2">
        <a href="#getters.">Getters.</a>
      </div>
      <div class="heading h3">
        <a href="#roler.getrolefor">Roler.getRoleFor</a>
      </div>
      <div class="heading h3">
        <a href="#roler.getidforrole">Roler.getIdForRole</a>
      </div>
      <div class="heading h3">
        <a href="#roler.getrolifiedmatches">Roler.getRolifiedMatches</a>
      </div>
      <div class="heading h3">
        <a href="#roler.getrolematch">Roler.getRoleMatch</a>
      </div>
      <div class="heading h3">
        <a href="#roler.getrole2idmatch">Roler.getRole2IdMatch</a>
      </div>
      <div class="heading h3">
        <a href="#roler.getid2rolematch">Roler.getId2RoleMatch</a>
      </div>
      <div class="heading h3">
        <a href="#roler.getrole2idroundmap">Roler.getRole2IdRoundMap</a>
      </div>
      <div class="heading h3">
        <a href="#roler.getid2roleroundmap">Roler.getId2RoleRoundMap</a>
      </div>
      <div class="heading h2">
        <a href="#rolify.">Rolify.</a>
      </div>
      <div class="heading h3">
        <a href="#roler.rolifyall">Roler.rolifyAll</a>
      </div>
      <div class="heading h2">
        <a href="#checkings.">Checkings.</a>
      </div>
      <div class="heading h3">
        <a href="#roler.roleexists">Roler.roleExists</a>
      </div>
      <div class="heading h3">
        <a href="#roler.hasrole">Roler.hasRole</a>
      </div>
      <div class="heading h2">
        <a href="#edit%2Freplace.">Edit/Replace.</a>
      </div>
      <div class="heading h3">
        <a href="#roler.replaceid">Roler.replaceId</a>
      </div>
      <div class="heading h2">
        <a href="#helper%20methods.">Helper methods.</a>
      </div>
      <div class="heading h3">
        <a href="#validateroleidmatches">validateRoleIdMatches</a>
      </div>
      <div class="heading h3">
        <a href="#validstring">validString</a>
      </div>
      <div class="heading h2">
        <a href="#closure">Closure</a>
      </div>
    </div>
  </div>
  <div id="sidebar-toggle"></div>
  <div id="container"><div class="background highlight"></div>
<table cellpadding="0" cellspacing="0">
  <tbody>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="roler">
  <h1>
    <a href="#roler" name="roler" class="pilcrow">&#182;</a>
    Roler
  </h1>
</div>


<p>Copyright(c) 2017 Stefano Balietti <a href="&#x6D;&#97;&#x69;&#x6C;&#x74;o:&#x73;&#116;&#101;&#64;&#x6E;&#111;&#100;&#101;&#x67;&#97;&#109;&#x65;&#x2E;&#111;&#x72;&#103;">&#x73;&#116;&#101;&#64;&#x6E;&#111;&#100;&#101;&#x67;&#97;&#109;&#x65;&#x2E;&#111;&#x72;&#103;</a>
MIT Licensed</p>
  </div>
  <div class="body"><p>Handles assigning roles to matches.</p>

<p>Currently only supports assigning roles to matches of size 2.</p>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">exports</span><span class="p">,</span> <span class="nx">parent</span><span class="p">)</span> <span class="p">{</span>

    <span class="s2">&quot;use strict&quot;</span><span class="p">;</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-2" id="section-2">&#182;</a>
</div>
<p>TODO: have x, y indexes like in Matcher?</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap" id="global%20scope">
  <h2>
    <a href="#global%20scope" name="global%20scope" class="pilcrow">&#182;</a>
    Global scope
  </h2>
</div>

        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">var</span> <span class="nx">J</span> <span class="o">=</span> <span class="nx">parent</span><span class="p">.</span><span class="nx">JSUS</span><span class="p">;</span>

    <span class="nx">exports</span><span class="p">.</span><span class="nx">Roler</span> <span class="o">=</span> <span class="nx">Roler</span><span class="p">;</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap" id="static%20methods.">
  <h2>
    <a href="#static%20methods." name="static%20methods." class="pilcrow">&#182;</a>
    Static methods.
  </h2>
</div>

        </td>
        <td class="code highlight"><div class="highlight"><pre>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="roler.linearrolifier">
  <h3>
    <a href="#roler.linearrolifier" name="roler.linearrolifier" class="pilcrow">&#182;</a>
    Roler.linearRolifier
  </h3>
</div>

  </div>
  <div class="body"><p>Applies roles to a single match</p>

<p>This is the default callback copied over <code>Matcher.rolify</code>.</p>
  </div>
  <div class="details">
    <div class="dox_tag_title">Params</div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">A</span>
      <span class="dox_type">array</span>
      <span>match array containing two valid ids, or
  one id and a 'missing-id'</span>
    </div>
    <div class="dox_tag_title">Returns</div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name"></span>
      <span class="dox_type">array</span>
      <span>roles An array containing the roles for the match.
  Missing ids will receive an undefined role</span>
    </div>
    <div class="dox_tag_title">See</div>
    <div class="dox_tag_detail">
      <span class="dox_type">Roler.rolify</span>
    </div>
    <div class="dox_tag_title">See</div>
    <div class="dox_tag_detail">
      <span class="dox_type">Roler.setRolifyCb
</span>
    </div>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="nx">Roler</span><span class="p">.</span><span class="nx">linearRolifier</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">match</span><span class="p">,</span> <span class="nx">x</span><span class="p">,</span> <span class="nx">y</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">roles</span><span class="p">,</span> <span class="nx">len</span><span class="p">;</span>
        <span class="kd">var</span> <span class="nx">id1</span><span class="p">,</span> <span class="nx">id2</span><span class="p">,</span> <span class="nx">soloIdx</span><span class="p">;</span>
        <span class="nx">len</span> <span class="o">=</span> <span class="nx">match</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">len</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="s1">&#39;Roler.rolify: match must be a non empty array. &#39;</span> <span class="o">+</span>
                            <span class="s1">&#39;Found: &#39;</span> <span class="o">+</span> <span class="nx">match</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="nx">id1</span> <span class="o">=</span> <span class="nx">match</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
        <span class="nx">id2</span> <span class="o">=</span> <span class="nx">match</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
        <span class="nx">roles</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Array</span><span class="p">(</span><span class="nx">len</span><span class="p">);</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">id1</span> <span class="o">!==</span> <span class="k">this</span><span class="p">.</span><span class="nx">missingId</span> <span class="o">&amp;&amp;</span> <span class="nx">id2</span> <span class="o">!==</span> <span class="k">this</span><span class="p">.</span><span class="nx">missingId</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">setRoleFor</span><span class="p">(</span><span class="nx">id1</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">rolesArray</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nx">x</span><span class="p">);</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">setRoleFor</span><span class="p">(</span><span class="nx">id2</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">rolesArray</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="nx">x</span><span class="p">);</span>
            <span class="nx">roles</span> <span class="o">=</span> <span class="p">[</span> <span class="k">this</span><span class="p">.</span><span class="nx">rolesArray</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="k">this</span><span class="p">.</span><span class="nx">rolesArray</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="p">];</span>
        <span class="p">}</span>
        <span class="k">else</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">rolesArray</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="p">{</span>
                <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="s1">&#39;Roler.rolify: role3 required, but not found.&#39;</span><span class="p">);</span>
            <span class="p">}</span>
            <span class="nx">soloIdx</span> <span class="o">=</span> <span class="p">(</span><span class="nx">id1</span> <span class="o">===</span> <span class="k">this</span><span class="p">.</span><span class="nx">missingId</span><span class="p">)</span> <span class="o">?</span> <span class="mi">1</span> <span class="o">:</span> <span class="mi">0</span><span class="p">;</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">setRoleFor</span><span class="p">(</span><span class="nx">match</span><span class="p">[</span><span class="nx">soloIdx</span><span class="p">],</span> <span class="k">this</span><span class="p">.</span><span class="nx">rolesArray</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="nx">x</span><span class="p">);</span>
            <span class="nx">roles</span><span class="p">[</span><span class="nx">soloIdx</span><span class="p">]</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">rolesArray</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="nx">roles</span><span class="p">;</span>
    <span class="p">};</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="roler%20constructor">
  <h2>
    <a href="#roler%20constructor" name="roler%20constructor" class="pilcrow">&#182;</a>
    Roler constructor
  </h2>
</div>

  </div>
  <div class="body"><p>Creates a new instance of role mapper</p>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">function</span> <span class="nx">Roler</span><span class="p">()</span> <span class="p">{</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="roler.roles">
  <h3>
    <a href="#roler.roles" name="roler.roles" class="pilcrow">&#182;</a>
    Roler.roles
  </h3>
</div>

  </div>
  <div class="body"><p>List of all available roles</p>
  </div>
  <div class="details">
    <div class="dox_tag_title">See</div>
    <div class="dox_tag_detail">
      <span class="dox_type">Roler.setRoles
</span>
    </div>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="k">this</span><span class="p">.</span><span class="nx">roles</span> <span class="o">=</span> <span class="p">{};</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="roler.rolesarray">
  <h3>
    <a href="#roler.rolesarray" name="roler.rolesarray" class="pilcrow">&#182;</a>
    Roler.rolesArray
  </h3>
</div>

  </div>
  <div class="body"><p>The array of currently available roles</p>
  </div>
  <div class="details">
    <div class="dox_tag_title">See</div>
    <div class="dox_tag_detail">
      <span class="dox_type">Roler.setRoles</span>
    </div>
    <div class="dox_tag_title">See</div>
    <div class="dox_tag_detail">
      <span class="dox_type">Roler.clear
</span>
    </div>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="k">this</span><span class="p">.</span><span class="nx">rolesArray</span> <span class="o">=</span> <span class="p">[];</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="roler.rolifiedmatches">
  <h3>
    <a href="#roler.rolifiedmatches" name="roler.rolifiedmatches" class="pilcrow">&#182;</a>
    Roler.rolifiedMatches
  </h3>
</div>

  </div>
  <div class="body"><p>Array of arrays of roles assigned for all matches in all rounds</p>

<p>For example:</p>


<div class="highlight"><pre><code><span class="p">[</span>
    <span class="c1">// Round 1.</span>
    <span class="p">[</span>  <span class="p">[</span> <span class="s1">&#39;ROLE_A&#39;</span><span class="p">,</span> <span class="s1">&#39;ROLE_B&#39;</span> <span class="p">],</span> <span class="p">[</span> <span class="s1">&#39;ROLE_A&#39;</span><span class="p">,</span> <span class="s1">&#39;ROLE_B&#39;</span> <span class="p">],</span> <span class="p">...</span> <span class="p">],</span>
    <span class="c1">// Round 2.</span>
    <span class="p">[</span>  <span class="p">[</span> <span class="s1">&#39;ROLE_A&#39;</span><span class="p">,</span> <span class="s1">&#39;ROLE_B&#39;</span> <span class="p">],</span> <span class="p">[</span> <span class="s1">&#39;ROLE_A&#39;</span><span class="p">,</span> <span class="s1">&#39;ROLE_B&#39;</span> <span class="p">],</span> <span class="p">...</span> <span class="p">],</span>
    <span class="p">...</span>
<span class="p">]</span>
</code></pre></div>


  </div>
  <div class="details">
    <div class="dox_tag_title">See</div>
    <div class="dox_tag_detail">
      <span class="dox_type">Roler.rolifyAll</span>
    </div>
    <div class="dox_tag_title">See</div>
    <div class="dox_tag_detail">
      <span class="dox_type">Roler.setRolifiedMatches
</span>
    </div>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="k">this</span><span class="p">.</span><span class="nx">rolifiedMatches</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="roler.role2idmatches">
  <h3>
    <a href="#roler.role2idmatches" name="roler.role2idmatches" class="pilcrow">&#182;</a>
    Roler.role2IdMatches
  </h3>
</div>

  </div>
  <div class="body"><p>Array of arrays of maps role to id/s for all matches in all rounds</p>

<p>For example:</p>


<div class="highlight"><pre><code><span class="p">[</span>
    <span class="p">[</span> <span class="p">{</span> <span class="nx">ROLE_A</span><span class="o">:</span> <span class="s1">&#39;ID1&#39;</span><span class="p">,</span> <span class="nx">ROLE_B</span><span class="o">:</span> <span class="s1">&#39;ID2&#39;</span> <span class="p">},</span> <span class="p">...</span> <span class="p">],</span> <span class="c1">// Round 1.</span>
    <span class="p">[</span> <span class="p">{</span> <span class="nx">ROLE_A</span><span class="o">:</span> <span class="p">[</span> <span class="s1">&#39;ID1&#39;</span><span class="p">,</span> <span class="s1">&#39;ID2&#39;</span> <span class="p">]</span> <span class="p">},</span> <span class="p">...</span> <span class="p">],</span> <span class="c1">// Round 2.</span>
    <span class="p">...</span>
<span class="p">]</span>
</code></pre></div>


  </div>
  <div class="details">
    <div class="dox_tag_title">See</div>
    <div class="dox_tag_detail">
      <span class="dox_type">Roler.rolifyAll</span>
    </div>
    <div class="dox_tag_title">See</div>
    <div class="dox_tag_detail">
      <span class="dox_type">Roler.setRolifiedMatches
</span>
    </div>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="k">this</span><span class="p">.</span><span class="nx">role2IdMatches</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="roler.id2rolematches">
  <h3>
    <a href="#roler.id2rolematches" name="roler.id2rolematches" class="pilcrow">&#182;</a>
    Roler.id2RoleMatches
  </h3>
</div>

  </div>
  <div class="body"><p>Array of arrays of maps id to role for all matches in all rounds</p>

<p>For example:</p>


<div class="highlight"><pre><code><span class="p">[</span>
    <span class="p">[</span> <span class="p">{</span> <span class="nx">ID1</span><span class="o">:</span> <span class="s1">&#39;ROLE_A&#39;</span><span class="p">,</span> <span class="nx">ID2</span><span class="o">:</span> <span class="s1">&#39;ROLE_B&#39;</span> <span class="p">},</span> <span class="p">...</span> <span class="p">],</span> <span class="c1">// Round 1.</span>
    <span class="p">[</span> <span class="p">{</span> <span class="nx">ID1</span><span class="o">:</span> <span class="s1">&#39;ROLE_A&#39;</span><span class="p">,</span> <span class="nx">ID2</span><span class="o">:</span> <span class="s1">&#39;ROLE_A&#39;</span> <span class="p">},</span> <span class="p">...</span> <span class="p">],</span> <span class="c1">// Round 2.</span>
    <span class="p">...</span>
<span class="p">]</span>
</code></pre></div>


  </div>
  <div class="details">
    <div class="dox_tag_title">See</div>
    <div class="dox_tag_detail">
      <span class="dox_type">Roler.rolifyAll</span>
    </div>
    <div class="dox_tag_title">See</div>
    <div class="dox_tag_detail">
      <span class="dox_type">Roler.setRolifiedMatches
</span>
    </div>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="k">this</span><span class="p">.</span><span class="nx">id2RoleMatches</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="roler.role2idroundmap">
  <h3>
    <a href="#roler.role2idroundmap" name="roler.role2idroundmap" class="pilcrow">&#182;</a>
    Roler.role2IdRoundMap
  </h3>
</div>

  </div>
  <div class="body"><p>Array of maps of role to id/s per each round</p>

<p>For example:</p>


<div class="highlight"><pre><code><span class="p">[</span>
    <span class="c1">// Round 1.</span>
    <span class="p">[</span> <span class="p">{</span> <span class="nx">ROLE_A</span><span class="o">:</span> <span class="p">[</span> <span class="s1">&#39;ID1&#39;</span><span class="p">,</span> <span class="s1">&#39;ID3&#39;</span><span class="p">,</span> <span class="p">...</span> <span class="p">],</span> <span class="nx">ROLE_B</span><span class="o">:</span> <span class="s1">&#39;ID2&#39;</span><span class="p">,</span> <span class="p">...</span> <span class="p">}</span> <span class="p">],</span>
    <span class="c1">// Round 2.</span>
    <span class="p">[</span> <span class="p">{</span> <span class="nx">ROLE_A</span><span class="o">:</span> <span class="p">[</span> <span class="s1">&#39;ID1&#39;</span><span class="p">,</span> <span class="s1">&#39;ID2&#39;</span><span class="p">,</span> <span class="p">...</span> <span class="p">],</span> <span class="nx">ROLE_B</span><span class="o">:</span> <span class="s1">&#39;ID3&#39;</span><span class="p">,</span> <span class="p">...</span> <span class="p">}</span> <span class="p">],</span>
    <span class="p">...</span>
<span class="p">]</span>
</code></pre></div>


  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="k">this</span><span class="p">.</span><span class="nx">role2IdRoundMap</span> <span class="o">=</span> <span class="p">[];</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="roler.rolify">
  <h3>
    <a href="#roler.rolify" name="roler.rolify" class="pilcrow">&#182;</a>
    Roler.rolify
  </h3>
</div>

  </div>
  <div class="body"><p>Callback that assigns roles to a single match</p>
  </div>
  <div class="details">
    <div class="dox_tag_title">See</div>
    <div class="dox_tag_detail">
      <span class="dox_type">Roler.linearRolifier
</span>
    </div>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="k">this</span><span class="p">.</span><span class="nx">rolify</span> <span class="o">=</span> <span class="nx">Roler</span><span class="p">.</span><span class="nx">linearRolifier</span><span class="p">;</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="roler.missingid">
  <h3>
    <a href="#roler.missingid" name="roler.missingid" class="pilcrow">&#182;</a>
    Roler.missingId
  </h3>
</div>

  </div>
  <div class="body"><p>The id indicating a skipped match (i.e. a bye in a match)</p>
  </div>
  <div class="details">
    <div class="dox_tag_title">See</div>
    <div class="dox_tag_detail">
      <span class="dox_type">Matcher.missingId
</span>
    </div>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="k">this</span><span class="p">.</span><span class="nx">missingId</span> <span class="o">=</span> <span class="s1">&#39;bot&#39;</span><span class="p">;</span>
    <span class="p">}</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap" id="init%2Fclear.">
  <h2>
    <a href="#init%2Fclear." name="init%2Fclear." class="pilcrow">&#182;</a>
    Init/clear.
  </h2>
</div>

        </td>
        <td class="code highlight"><div class="highlight"><pre>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="roler.init">
  <h3>
    <a href="#roler.init" name="roler.init" class="pilcrow">&#182;</a>
    Roler.init
  </h3>
</div>

  </div>
  <div class="body"><p>Inits the Roler instance</p>
  </div>
  <div class="details">
    <div class="dox_tag_title">Params</div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">options
</span>
      <span class="dox_type">object</span>
    </div>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="nx">Roler</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">init</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">options</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">options</span> <span class="o">=</span> <span class="nx">options</span> <span class="o">||</span> <span class="p">{};</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">options</span><span class="p">.</span><span class="nx">rolifyCb</span><span class="p">)</span> <span class="k">this</span><span class="p">.</span><span class="nx">setRolifyCb</span><span class="p">(</span><span class="nx">options</span><span class="p">.</span><span class="nx">rolifyCb</span><span class="p">);</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">options</span><span class="p">.</span><span class="nx">roles</span><span class="p">)</span> <span class="k">this</span><span class="p">.</span><span class="nx">setRoles</span><span class="p">(</span><span class="nx">options</span><span class="p">.</span><span class="nx">roles</span><span class="p">);</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">options</span><span class="p">.</span><span class="nx">missingId</span><span class="p">)</span> <span class="k">this</span><span class="p">.</span><span class="nx">missingId</span> <span class="o">=</span> <span class="nx">options</span><span class="p">.</span><span class="nx">missingId</span><span class="p">;</span>
    <span class="p">};</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="roler.clear">
  <h3>
    <a href="#roler.clear" name="roler.clear" class="pilcrow">&#182;</a>
    Roler.clear
  </h3>
</div>

  </div>
  <div class="body"><p>Clears all roles lists</p>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="nx">Roler</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">clear</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">roles</span> <span class="o">=</span> <span class="p">{};</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">rolesArray</span> <span class="o">=</span> <span class="p">[];</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">id2RoleRoundMap</span> <span class="o">=</span> <span class="p">[];</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">role2IdRoundMap</span> <span class="o">=</span> <span class="p">[];</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">rolifiedMatches</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">role2IdMatches</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">id2RoleMatches</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
    <span class="p">};</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap" id="setters.">
  <h2>
    <a href="#setters." name="setters." class="pilcrow">&#182;</a>
    Setters.
  </h2>
</div>

        </td>
        <td class="code highlight"><div class="highlight"><pre>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="roler.setrolifycb">
  <h3>
    <a href="#roler.setrolifycb" name="roler.setrolifycb" class="pilcrow">&#182;</a>
    Roler.setRolifyCb
  </h3>
</div>

  </div>
  <div class="body"><p>Sets the callback assigning the roles</p>

<p>The callback takes as input a match array, and optionally its
x and y coordinates in the array of matches.</p>
  </div>
  <div class="details">
    <div class="dox_tag_title">Params</div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">cb</span>
      <span class="dox_type">function</span>
      <span>The rolifier cb</span>
    </div>
    <div class="dox_tag_title">See</div>
    <div class="dox_tag_detail">
      <span class="dox_type">Roler.rolify
</span>
    </div>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="nx">Roler</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">setRolifyCb</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">cb</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;function&#39;</span> <span class="o">!==</span> <span class="k">typeof</span> <span class="nx">cb</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nx">TypeError</span><span class="p">(</span><span class="s1">&#39;Roler.setRolifyCb: cb must be function. &#39;</span> <span class="o">+</span>
                                <span class="s1">&#39;Found: &#39;</span> <span class="o">+</span> <span class="nx">cb</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">rolify</span> <span class="o">=</span> <span class="nx">cb</span><span class="p">;</span>
    <span class="p">};</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="roler.setroles">
  <h3>
    <a href="#roler.setroles" name="roler.setroles" class="pilcrow">&#182;</a>
    Roler.setRoles
  </h3>
</div>

  </div>
  <div class="body"><p>Validates and sets the roles</p>
  </div>
  <div class="details">
    <div class="dox_tag_title">Params</div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">roles</span>
      <span class="dox_type">array</span>
      <span>Array of roles (string)</span>
    </div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">min</span>
      <span class="dox_type">number</span>
      <span>At least <em>min</em> roles must be specified. Default: 2</span>
    </div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">max</span>
      <span class="dox_type">number</span>
      <span>At least <em>max</em> roles must be specified. Default: inf</span>
    </div>
    <div class="dox_tag_title">See</div>
    <div class="dox_tag_detail">
      <span class="dox_type">Roler.setRoles</span>
    </div>
    <div class="dox_tag_title">See</div>
    <div class="dox_tag_detail">
      <span class="dox_type">Roler.clear
</span>
    </div>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="nx">Roler</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">setRoles</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">roles</span><span class="p">,</span> <span class="nx">min</span><span class="p">,</span> <span class="nx">max</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">rolesObj</span><span class="p">,</span> <span class="nx">role</span><span class="p">;</span>
        <span class="kd">var</span> <span class="nx">i</span><span class="p">,</span> <span class="nx">len</span><span class="p">;</span>
        <span class="kd">var</span> <span class="nx">err</span><span class="p">;</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-21" id="section-21">&#182;</a>
</div>
<p>Clear previousd data.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="k">this</span><span class="p">.</span><span class="nx">clear</span><span class="p">();</span>

        <span class="k">if</span> <span class="p">(</span><span class="nx">min</span> <span class="o">&amp;&amp;</span> <span class="s1">&#39;number&#39;</span> <span class="o">!==</span> <span class="k">typeof</span> <span class="nx">min</span> <span class="o">||</span> <span class="nx">min</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nx">TypeError</span><span class="p">(</span><span class="s1">&#39;Roler.setRoles: min must be a &#39;</span> <span class="o">+</span>
                                <span class="s1">&#39;number &gt; 2 or undefined. Found: &#39;</span> <span class="o">+</span> <span class="nx">min</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="nx">min</span> <span class="o">=</span> <span class="nx">min</span> <span class="o">||</span> <span class="mi">2</span><span class="p">;</span>

        <span class="k">if</span> <span class="p">(</span><span class="nx">max</span> <span class="o">&amp;&amp;</span> <span class="s1">&#39;number&#39;</span> <span class="o">!==</span> <span class="k">typeof</span> <span class="nx">max</span> <span class="o">||</span> <span class="nx">max</span> <span class="o">&lt;</span> <span class="nx">min</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nx">TypeError</span><span class="p">(</span><span class="s1">&#39;Roler.setRoles: max must &#39;</span> <span class="o">+</span>
                                <span class="s1">&#39;be number or undefined. Found: &#39;</span> <span class="o">+</span> <span class="nx">max</span><span class="p">);</span>
        <span class="p">}</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-22" id="section-22">&#182;</a>
</div>
<p>At least two roles must be defined</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">J</span><span class="p">.</span><span class="nx">isArray</span><span class="p">(</span><span class="nx">roles</span><span class="p">))</span> <span class="p">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nx">TypeError</span><span class="p">(</span><span class="s1">&#39;Roler.setRoles: roles must &#39;</span> <span class="o">+</span>
                                <span class="s1">&#39;be array. Found: &#39;</span> <span class="o">+</span> <span class="nx">roles</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="nx">len</span> <span class="o">=</span> <span class="nx">roles</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-23" id="section-23">&#182;</a>
</div>
<p>At least two roles must be defined</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="k">if</span> <span class="p">(</span><span class="nx">len</span> <span class="o">&lt;</span> <span class="nx">min</span> <span class="o">||</span> <span class="nx">len</span> <span class="o">&gt;</span> <span class="nx">max</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">err</span> <span class="o">=</span> <span class="s1">&#39;Roler.setRoles: roles must contain at least &#39;</span> <span class="o">+</span>
                <span class="nx">min</span> <span class="o">+</span> <span class="s1">&#39; roles&#39;</span><span class="p">;</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">max</span><span class="p">)</span> <span class="nx">err</span> <span class="o">+=</span> <span class="s1">&#39; and no more than &#39;</span> <span class="o">+</span> <span class="nx">max</span><span class="p">;</span>
            <span class="nx">err</span> <span class="o">+=</span> <span class="s1">&#39;. Found: &#39;</span> <span class="o">+</span> <span class="nx">len</span><span class="p">;</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="nx">err</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="nx">rolesObj</span> <span class="o">=</span> <span class="p">{};</span>
        <span class="nx">i</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
        <span class="k">for</span> <span class="p">(</span> <span class="p">;</span> <span class="o">++</span><span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">len</span> <span class="p">;</span> <span class="p">)</span> <span class="p">{</span>
            <span class="nx">role</span> <span class="o">=</span> <span class="nx">roles</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
            <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;string&#39;</span> <span class="o">!==</span> <span class="k">typeof</span> <span class="nx">role</span> <span class="o">||</span> <span class="nx">role</span><span class="p">.</span><span class="nx">trim</span><span class="p">()</span> <span class="o">===</span> <span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">throw</span> <span class="k">new</span> <span class="nx">TypeError</span><span class="p">(</span><span class="s1">&#39;Roler.setRoles: each role &#39;</span> <span class="o">+</span>
                                    <span class="s1">&#39;must be a non-empty string. Found: &#39;</span> <span class="o">+</span>
                                    <span class="nx">role</span><span class="p">);</span>
            <span class="p">}</span>
            <span class="nx">rolesObj</span><span class="p">[</span><span class="nx">role</span><span class="p">]</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
        <span class="p">}</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-24" id="section-24">&#182;</a>
</div>
<p>All data validated.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="k">this</span><span class="p">.</span><span class="nx">roles</span> <span class="o">=</span> <span class="nx">rolesObj</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">rolesArray</span> <span class="o">=</span> <span class="nx">roles</span><span class="p">;</span>
    <span class="p">};</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="roler.setrolefor">
  <h3>
    <a href="#roler.setrolefor" name="roler.setrolefor" class="pilcrow">&#182;</a>
    Roler.setRoleFor
  </h3>
</div>

  </div>
  <div class="body"><p>Sets a role for the given id at the specified round</p>
  </div>
  <div class="details">
    <div class="dox_tag_title">Params</div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">id</span>
      <span class="dox_type">string</span>
      <span>The id of a player</span>
    </div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">role</span>
      <span class="dox_type">string</span>
      <span>A valid role for the id</span>
    </div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">x</span>
      <span class="dox_type">number</span>
      <span>The x-th round the role is being set for</span>
    </div>
    <div class="dox_tag_title">See</div>
    <div class="dox_tag_detail">
      <span class="dox_type">Roler.id2RoleRoundMap</span>
    </div>
    <div class="dox_tag_title">See</div>
    <div class="dox_tag_detail">
      <span class="dox_type">Roler.role2IdRoundMap
</span>
    </div>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="nx">Roler</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">setRoleFor</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">id</span><span class="p">,</span> <span class="nx">role</span><span class="p">,</span> <span class="nx">x</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;string&#39;</span> <span class="o">!==</span> <span class="k">typeof</span> <span class="nx">id</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nx">TypeError</span><span class="p">(</span><span class="s1">&#39;Roler.setRoleFor: id must be string. Found: &#39;</span> <span class="o">+</span>
                                <span class="nx">id</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;string&#39;</span> <span class="o">!==</span> <span class="k">typeof</span> <span class="nx">role</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nx">TypeError</span><span class="p">(</span><span class="s1">&#39;Roler.setRoleFor: role must be string. &#39;</span> <span class="o">+</span>
                                <span class="s1">&#39;Found: &#39;</span> <span class="o">+</span> <span class="nx">role</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">roles</span><span class="p">[</span><span class="nx">role</span><span class="p">])</span> <span class="p">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="s1">&#39;Roler.setRoleFor: unknown role: &#39;</span> <span class="o">+</span> <span class="nx">role</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;number&#39;</span> <span class="o">!==</span> <span class="k">typeof</span> <span class="nx">x</span> <span class="o">||</span> <span class="nx">x</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="o">||</span> <span class="nb">isNaN</span><span class="p">(</span><span class="nx">x</span><span class="p">))</span> <span class="p">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nx">TypeError</span><span class="p">(</span><span class="s1">&#39;Roler.setRoleFor: x must be a non-negative &#39;</span> <span class="o">+</span>
                                <span class="s1">&#39;number. Found: &#39;</span> <span class="o">+</span> <span class="nx">x</span><span class="p">);</span>
        <span class="p">}</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-26" id="section-26">&#182;</a>
</div>
<p>Id to role.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">id2RoleRoundMap</span><span class="p">[</span><span class="nx">x</span><span class="p">])</span> <span class="k">this</span><span class="p">.</span><span class="nx">id2RoleRoundMap</span><span class="p">[</span><span class="nx">x</span><span class="p">]</span> <span class="o">=</span> <span class="p">{};</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">id2RoleRoundMap</span><span class="p">[</span><span class="nx">x</span><span class="p">][</span><span class="nx">id</span><span class="p">]</span> <span class="o">=</span> <span class="nx">role</span><span class="p">;</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-27" id="section-27">&#182;</a>
</div>
<p>Role to id.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">role2IdRoundMap</span><span class="p">[</span><span class="nx">x</span><span class="p">])</span> <span class="k">this</span><span class="p">.</span><span class="nx">role2IdRoundMap</span><span class="p">[</span><span class="nx">x</span><span class="p">]</span> <span class="o">=</span> <span class="p">{};</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">role2IdRoundMap</span><span class="p">[</span><span class="nx">x</span><span class="p">][</span><span class="nx">role</span><span class="p">])</span> <span class="k">this</span><span class="p">.</span><span class="nx">role2IdRoundMap</span><span class="p">[</span><span class="nx">x</span><span class="p">][</span><span class="nx">role</span><span class="p">]</span> <span class="o">=</span> <span class="p">[];</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">role2IdRoundMap</span><span class="p">[</span><span class="nx">x</span><span class="p">][</span><span class="nx">role</span><span class="p">].</span><span class="nx">push</span><span class="p">(</span><span class="nx">id</span><span class="p">);</span>
    <span class="p">};</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="roler.setrolifiedmatches">
  <h3>
    <a href="#roler.setrolifiedmatches" name="roler.setrolifiedmatches" class="pilcrow">&#182;</a>
    Roler.setRolifiedMatches
  </h3>
</div>

  </div>
  <div class="body"><p>Sets a preinited array of rolified matches</p>
  </div>
  <div class="details">
    <div class="dox_tag_title">Params</div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">rolifiedMatches</span>
      <span class="dox_type">array</span>
      <span>The rolified matches</span>
    </div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">validate</span>
      <span class="dox_type">boolean</span>
      <span>Optional. Boolean flag to
  turn on/off validation. Default: TRUE</span>
    </div>
    <div class="dox_tag_title">See</div>
    <div class="dox_tag_detail">
      <span class="dox_type">Roler.rolifiedMatches
</span>
    </div>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="nx">Roler</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">setRolifiedMatches</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">rolifiedMatches</span><span class="p">,</span> <span class="nx">validate</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">i</span><span class="p">,</span> <span class="nx">len</span><span class="p">;</span>
        <span class="kd">var</span> <span class="nx">j</span><span class="p">,</span> <span class="nx">lenJ</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;undefined&#39;</span> <span class="o">===</span> <span class="k">typeof</span> <span class="nx">validate</span> <span class="o">||</span> <span class="o">!!</span><span class="nx">validate</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">J</span><span class="p">.</span><span class="nx">isArray</span><span class="p">(</span><span class="nx">rolifiedMatches</span><span class="p">)</span> <span class="o">||</span> <span class="o">!</span><span class="nx">rolifiedMatches</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="s1">&#39;Roler.setRolifiedMatches: rolifiedMatches &#39;</span> <span class="o">+</span>
                                <span class="s1">&#39;must be a non-empty array. Found: &#39;</span> <span class="o">+</span>
                                <span class="nx">rolifiedMatches</span><span class="p">);</span>
            <span class="p">}</span>
            <span class="nx">i</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="nx">len</span> <span class="o">=</span> <span class="nx">rolifiedMatches</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
            <span class="k">for</span> <span class="p">(</span> <span class="p">;</span> <span class="o">++</span><span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">len</span> <span class="p">;</span> <span class="p">)</span> <span class="p">{</span>
                <span class="nx">i</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="nx">lenJ</span> <span class="o">=</span> <span class="nx">rolifiedMatches</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">length</span><span class="p">;</span>
                <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">lenJ</span><span class="p">)</span> <span class="p">{</span>
                    <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="s1">&#39;Roler.setRolifiedMatches: &#39;</span> <span class="o">+</span>
                                    <span class="s1">&#39;rolifiedMatches round &#39;</span> <span class="o">+</span> <span class="nx">i</span> <span class="o">+</span>
                                    <span class="s1">&#39;has no elements.&#39;</span><span class="p">);</span>
                <span class="p">}</span>
                <span class="k">for</span> <span class="p">(</span> <span class="p">;</span> <span class="o">++</span><span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">lenJ</span> <span class="p">;</span> <span class="p">)</span> <span class="p">{</span>
                    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">J</span><span class="p">.</span><span class="nx">isArray</span><span class="p">(</span><span class="nx">rolifiedMatches</span><span class="p">[</span><span class="nx">i</span><span class="p">][</span><span class="nx">j</span><span class="p">]))</span> <span class="p">{</span>
                        <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="s1">&#39;Roler.setRolifiedMatches: &#39;</span> <span class="o">+</span>
                                        <span class="s1">&#39;rolifiedMatches round &#39;</span> <span class="o">+</span> <span class="nx">i</span> <span class="o">+</span>
                                        <span class="s1">&#39; element &#39;</span> <span class="o">+</span> <span class="nx">j</span> <span class="o">+</span>
                                        <span class="s1">&#39; should be array. Found: &#39;</span> <span class="o">+</span>
                                        <span class="nx">rolifiedMatches</span><span class="p">[</span><span class="nx">i</span><span class="p">][</span><span class="nx">j</span><span class="p">]);</span>
                    <span class="p">}</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-29" id="section-29">&#182;</a>
</div>
<p>These are specific to the rolify cb.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
                    <span class="k">if</span> <span class="p">(</span><span class="nx">rolifiedMatches</span><span class="p">[</span><span class="nx">i</span><span class="p">][</span><span class="nx">j</span><span class="p">].</span><span class="nx">length</span> <span class="o">!==</span> <span class="mi">2</span><span class="p">)</span> <span class="p">{</span>
                        <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="s1">&#39;Roler.setRolifiedMatches: roles (&#39;</span> <span class="o">+</span>
                                        <span class="nx">i</span> <span class="o">+</span> <span class="s1">&#39;,&#39;</span> <span class="o">+</span> <span class="nx">j</span> <span class="o">+</span> <span class="s1">&#39;) was expected to have&#39;</span> <span class="o">+</span>
                                        <span class="s1">&#39; length 2: &#39;</span> <span class="o">+</span> <span class="nx">rolifiedMatches</span><span class="p">[</span><span class="nx">i</span><span class="p">][</span><span class="nx">j</span><span class="p">]);</span>
                    <span class="p">}</span>
                    <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;string&#39;</span> <span class="o">!==</span> <span class="k">typeof</span> <span class="nx">rolifiedMatches</span><span class="p">[</span><span class="nx">i</span><span class="p">][</span><span class="nx">j</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">||</span>
                        <span class="s1">&#39;string&#39;</span> <span class="o">!==</span> <span class="k">typeof</span> <span class="nx">rolifiedMatches</span><span class="p">[</span><span class="nx">i</span><span class="p">][</span><span class="nx">j</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">||</span>
                        <span class="nx">rolifiedMatches</span><span class="p">[</span><span class="nx">i</span><span class="p">][</span><span class="nx">j</span><span class="p">][</span><span class="mi">0</span><span class="p">].</span><span class="nx">trim</span><span class="p">()</span> <span class="o">===</span> <span class="s1">&#39;&#39;</span> <span class="o">||</span>
                        <span class="nx">rolifiedMatches</span><span class="p">[</span><span class="nx">i</span><span class="p">][</span><span class="nx">j</span><span class="p">][</span><span class="mi">1</span><span class="p">].</span><span class="nx">trim</span><span class="p">()</span> <span class="o">===</span> <span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="p">{</span>

                        <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="s1">&#39;Roler.setRolifiedMatches: roles (&#39;</span> <span class="o">+</span>
                                        <span class="nx">i</span> <span class="o">+</span> <span class="s1">&#39;,&#39;</span> <span class="o">+</span> <span class="nx">j</span> <span class="o">+</span> <span class="s1">&#39;) has invalid &#39;</span> <span class="o">+</span>
                                        <span class="s1">&#39;elements: &#39;</span> <span class="o">+</span> <span class="nx">rolifiedMatches</span><span class="p">[</span><span class="nx">i</span><span class="p">][</span><span class="nx">j</span><span class="p">]);</span>
                    <span class="p">}</span>
                <span class="p">}</span>

            <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">rolifiedMatches</span> <span class="o">=</span> <span class="nx">rolifiedMatches</span><span class="p">;</span>
    <span class="p">};</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="roler.setrole2idmatches">
  <h3>
    <a href="#roler.setrole2idmatches" name="roler.setrole2idmatches" class="pilcrow">&#182;</a>
    Roler.setRole2IdMatches
  </h3>
</div>

  </div>
  <div class="body"><p>Sets a preinited array of role to id/s matches</p>
  </div>
  <div class="details">
    <div class="dox_tag_title">Params</div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">matches</span>
      <span class="dox_type">array</span>
      <span>The role to id/s matches</span>
    </div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">validate</span>
      <span class="dox_type">boolean</span>
      <span>Optional. Boolean flag to
  turn on/off validation. Default: TRUE</span>
    </div>
    <div class="dox_tag_title">See</div>
    <div class="dox_tag_detail">
      <span class="dox_type">Roler.rolifiedMatches
</span>
    </div>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="nx">Roler</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">setRole2IdMatches</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">matches</span><span class="p">,</span> <span class="nx">validate</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;undefined&#39;</span> <span class="o">===</span> <span class="k">typeof</span> <span class="nx">validate</span> <span class="o">||</span> <span class="o">!!</span><span class="nx">validate</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">validateRoleIdMatches</span><span class="p">(</span><span class="s1">&#39;setRole2IdMatches&#39;</span><span class="p">,</span> <span class="nx">matches</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">role2IdMatches</span> <span class="o">=</span> <span class="nx">matches</span><span class="p">;</span>
    <span class="p">};</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="roler.setid2rolematches">
  <h3>
    <a href="#roler.setid2rolematches" name="roler.setid2rolematches" class="pilcrow">&#182;</a>
    Roler.setId2RoleMatches
  </h3>
</div>

  </div>
  <div class="body"><p>Sets a preinited array of id to role matches</p>
  </div>
  <div class="details">
    <div class="dox_tag_title">Params</div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">matches</span>
      <span class="dox_type">array</span>
      <span>The roles-obj matches</span>
    </div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">validate</span>
      <span class="dox_type">boolean</span>
      <span>Optional. Boolean flag to
  turn on/off validation. Default: TRUE</span>
    </div>
    <div class="dox_tag_title">See</div>
    <div class="dox_tag_detail">
      <span class="dox_type">Roler.id2RoleMatches
</span>
    </div>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="nx">Roler</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">setId2RoleMatches</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">matches</span><span class="p">,</span> <span class="nx">validate</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;undefined&#39;</span> <span class="o">===</span> <span class="k">typeof</span> <span class="nx">validate</span> <span class="o">||</span> <span class="o">!!</span><span class="nx">validate</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">validateRoleIdMatches</span><span class="p">(</span><span class="s1">&#39;setId2RoleMatches&#39;</span><span class="p">,</span> <span class="nx">matches</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">id2RoleMatches</span> <span class="o">=</span> <span class="nx">matches</span><span class="p">;</span>
    <span class="p">};</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap" id="getters.">
  <h2>
    <a href="#getters." name="getters." class="pilcrow">&#182;</a>
    Getters.
  </h2>
</div>

        </td>
        <td class="code highlight"><div class="highlight"><pre>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="roler.getrolefor">
  <h3>
    <a href="#roler.getrolefor" name="roler.getrolefor" class="pilcrow">&#182;</a>
    Roler.getRoleFor
  </h3>
</div>

  </div>
  <div class="body"><p>Returns the role hold by an id at round x</p>
  </div>
  <div class="details">
    <div class="dox_tag_title">Params</div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">id</span>
      <span class="dox_type">string</span>
      <span>The id to check</span>
    </div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">x</span>
      <span class="dox_type">number</span>
      <span>The round to check</span>
    </div>
    <div class="dox_tag_title">Returns</div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name"></span>
      <span class="dox_type">string</span>
      <span class="dox_type">null</span>
      <span>The role currently hold, or null
   if the id is not found</span>
    </div>
    <div class="dox_tag_title">See</div>
    <div class="dox_tag_detail">
      <span class="dox_type">Roler.id2RoleRoundMap
</span>
    </div>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="nx">Roler</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">getRoleFor</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">id</span><span class="p">,</span> <span class="nx">x</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;string&#39;</span> <span class="o">!==</span> <span class="k">typeof</span> <span class="nx">id</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nx">TypeError</span><span class="p">(</span><span class="s1">&#39;Roler.getRoleFor: id must be string. Found: &#39;</span> <span class="o">+</span>
                                <span class="nx">id</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;number&#39;</span> <span class="o">!==</span> <span class="k">typeof</span> <span class="nx">x</span> <span class="o">||</span> <span class="nx">x</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="o">||</span> <span class="nb">isNaN</span><span class="p">(</span><span class="nx">x</span><span class="p">))</span> <span class="p">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nx">TypeError</span><span class="p">(</span><span class="s1">&#39;Roler.getRoleFor: x must be a non-negative &#39;</span> <span class="o">+</span>
                                <span class="s1">&#39;number. Found: &#39;</span> <span class="o">+</span> <span class="nx">x</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">id2RoleRoundMap</span><span class="p">[</span><span class="nx">x</span><span class="p">][</span><span class="nx">id</span><span class="p">]</span> <span class="o">||</span> <span class="kc">null</span><span class="p">;</span>
    <span class="p">};</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="roler.getidforrole">
  <h3>
    <a href="#roler.getidforrole" name="roler.getidforrole" class="pilcrow">&#182;</a>
    Roler.getIdForRole
  </h3>
</div>

  </div>
  <div class="body"><p>Returns the id/s holding the specified role at round x</p>
  </div>
  <div class="details">
    <div class="dox_tag_title">Params</div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">role</span>
      <span class="dox_type">string</span>
      <span>The role</span>
    </div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">x</span>
      <span class="dox_type">number</span>
      <span>The round</span>
    </div>
    <div class="dox_tag_title">Returns</div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name"></span>
      <span class="dox_type">array</span>
      <span>Array of id/s holding the role at round x</span>
    </div>
    <div class="dox_tag_title">See</div>
    <div class="dox_tag_detail">
      <span class="dox_type">Roler.role2IdRoundMap
</span>
    </div>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="nx">Roler</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">getIdForRole</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">role</span><span class="p">,</span> <span class="nx">x</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;string&#39;</span> <span class="o">!==</span> <span class="k">typeof</span> <span class="nx">role</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nx">TypeError</span><span class="p">(</span><span class="s1">&#39;Roler.getIdForRole: role must be string. &#39;</span> <span class="o">+</span>
                                <span class="s1">&#39;Found: &#39;</span> <span class="o">+</span> <span class="nx">role</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;number&#39;</span> <span class="o">!==</span> <span class="k">typeof</span> <span class="nx">x</span> <span class="o">||</span> <span class="nx">x</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="o">||</span> <span class="nb">isNaN</span><span class="p">(</span><span class="nx">x</span><span class="p">))</span> <span class="p">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nx">TypeError</span><span class="p">(</span><span class="s1">&#39;Roler.getIdForRole: x must be a &#39;</span> <span class="o">+</span>
                                <span class="s1">&#39;non-negative number. Found: &#39;</span> <span class="o">+</span> <span class="nx">x</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">role2IdRoundMap</span><span class="p">[</span><span class="nx">x</span><span class="p">][</span><span class="nx">role</span><span class="p">]</span> <span class="o">||</span> <span class="p">[];</span>
    <span class="p">};</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="roler.getrolifiedmatches">
  <h3>
    <a href="#roler.getrolifiedmatches" name="roler.getrolifiedmatches" class="pilcrow">&#182;</a>
    Roler.getRolifiedMatches
  </h3>
</div>

  </div>
  <div class="body"><p>Returns all matched roles</p>
  </div>
  <div class="details">
    <div class="dox_tag_title">Returns</div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name"></span>
      <span class="dox_type">array</span>
      <span>The matched roles</span>
    </div>
    <div class="dox_tag_title">See</div>
    <div class="dox_tag_detail">
      <span class="dox_type">Roler.rolifiedMatches
</span>
    </div>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="nx">Roler</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">getRolifiedMatches</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">rolifiedMatches</span><span class="p">;</span>
    <span class="p">};</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="roler.getrolematch">
  <h3>
    <a href="#roler.getrolematch" name="roler.getrolematch" class="pilcrow">&#182;</a>
    Roler.getRoleMatch
  </h3>
</div>

  </div>
  <div class="body"><p>Returns the requested roles</p>
  </div>
  <div class="details">
    <div class="dox_tag_title">Params</div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">x</span>
      <span class="dox_type">number</span>
      <span>The round of the roles</span>
    </div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">y</span>
      <span class="dox_type">number</span>
      <span>Optional. The y-th role within round x</span>
    </div>
    <div class="dox_tag_title">Returns</div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name"></span>
      <span class="dox_type">array</span>
      <span class="dox_type">null</span>
      <span>The requested role matches or null
   if the x or y indexes are out of bounds</span>
    </div>
    <div class="dox_tag_title">See</div>
    <div class="dox_tag_detail">
      <span class="dox_type">Roler.rolifiedMatches
</span>
    </div>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="nx">Roler</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">getRoleMatch</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">x</span><span class="p">,</span> <span class="nx">y</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;number&#39;</span> <span class="o">!==</span> <span class="k">typeof</span> <span class="nx">x</span> <span class="o">||</span> <span class="nx">x</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="o">||</span> <span class="nb">isNaN</span><span class="p">(</span><span class="nx">x</span><span class="p">))</span> <span class="p">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nx">TypeError</span><span class="p">(</span><span class="s1">&#39;Roler.getRoleMatch: x must be a &#39;</span> <span class="o">+</span>
                                <span class="s1">&#39;non-negative number. Found: &#39;</span> <span class="o">+</span> <span class="nx">x</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;undefined&#39;</span> <span class="o">===</span> <span class="k">typeof</span> <span class="nx">y</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">rolifiedMatches</span><span class="p">[</span><span class="nx">x</span><span class="p">]</span> <span class="o">||</span> <span class="kc">null</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;number&#39;</span> <span class="o">!==</span> <span class="k">typeof</span> <span class="nx">y</span> <span class="o">||</span> <span class="nx">y</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="o">||</span> <span class="nb">isNaN</span><span class="p">(</span><span class="nx">y</span><span class="p">))</span> <span class="p">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nx">TypeError</span><span class="p">(</span><span class="s1">&#39;Roler.getRoleMatch: y must be undefined or &#39;</span> <span class="o">+</span>
                                <span class="s1">&#39;a non-negative number. Found: &#39;</span> <span class="o">+</span> <span class="nx">y</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">rolifiedMatches</span><span class="p">[</span><span class="nx">x</span><span class="p">][</span><span class="nx">y</span><span class="p">]</span> <span class="o">||</span> <span class="kc">null</span><span class="p">;</span>
    <span class="p">};</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="roler.getrole2idmatch">
  <h3>
    <a href="#roler.getrole2idmatch" name="roler.getrole2idmatch" class="pilcrow">&#182;</a>
    Roler.getRole2IdMatch
  </h3>
</div>

  </div>
  <div class="body"><p>Returns the requested role to id matches</p>
  </div>
  <div class="details">
    <div class="dox_tag_title">Params</div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">x</span>
      <span class="dox_type">number</span>
      <span>The round of the roles</span>
    </div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">y</span>
      <span class="dox_type">number</span>
      <span>Optional. The y-th role within round x</span>
    </div>
    <div class="dox_tag_title">Returns</div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name"></span>
      <span class="dox_type">array</span>
      <span class="dox_type">object</span>
      <span class="dox_type">null</span>
      <span>The role to id/s matches or null
   if the x or y indexes are out of bounds</span>
    </div>
    <div class="dox_tag_title">See</div>
    <div class="dox_tag_detail">
      <span class="dox_type">Roler.role2IdRoundMatch
</span>
    </div>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="nx">Roler</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">getRole2IdMatch</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">x</span><span class="p">,</span> <span class="nx">y</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;number&#39;</span> <span class="o">!==</span> <span class="k">typeof</span> <span class="nx">x</span> <span class="o">||</span> <span class="nx">x</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="o">||</span> <span class="nb">isNaN</span><span class="p">(</span><span class="nx">x</span><span class="p">))</span> <span class="p">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nx">TypeError</span><span class="p">(</span><span class="s1">&#39;Roler.getRole2IdMatch: x must be a &#39;</span> <span class="o">+</span>
                                <span class="s1">&#39;non-negative number. Found: &#39;</span> <span class="o">+</span> <span class="nx">x</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;undefined&#39;</span> <span class="o">===</span> <span class="k">typeof</span> <span class="nx">y</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">role2IdMatches</span><span class="p">[</span><span class="nx">x</span><span class="p">]</span> <span class="o">||</span> <span class="kc">null</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;number&#39;</span> <span class="o">!==</span> <span class="k">typeof</span> <span class="nx">y</span> <span class="o">||</span> <span class="nx">y</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="o">||</span> <span class="nb">isNaN</span><span class="p">(</span><span class="nx">y</span><span class="p">))</span> <span class="p">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nx">TypeError</span><span class="p">(</span><span class="s1">&#39;Roler.getRole2IdMatch: y must be a &#39;</span> <span class="o">+</span>
                                <span class="s1">&#39;non-negative number. Found: &#39;</span> <span class="o">+</span> <span class="nx">y</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">role2IdMatches</span><span class="p">[</span><span class="nx">x</span><span class="p">][</span><span class="nx">y</span><span class="p">]</span> <span class="o">||</span> <span class="kc">null</span><span class="p">;</span>
    <span class="p">};</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="roler.getid2rolematch">
  <h3>
    <a href="#roler.getid2rolematch" name="roler.getid2rolematch" class="pilcrow">&#182;</a>
    Roler.getId2RoleMatch
  </h3>
</div>

  </div>
  <div class="body"><p>Returns the requested id to role matches</p>
  </div>
  <div class="details">
    <div class="dox_tag_title">Params</div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">x</span>
      <span class="dox_type">number</span>
      <span>The round of the roles</span>
    </div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">y</span>
      <span class="dox_type">number</span>
      <span>Optional. The y-th role within round x</span>
    </div>
    <div class="dox_tag_title">Returns</div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name"></span>
      <span class="dox_type">array</span>
      <span class="dox_type">object</span>
      <span class="dox_type">null</span>
      <span>The id to role matches or null
   if the x or y indexes are out of bounds</span>
    </div>
    <div class="dox_tag_title">See</div>
    <div class="dox_tag_detail">
      <span class="dox_type">Roler.rolifiedMatches
</span>
    </div>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="nx">Roler</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">getId2RoleMatch</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">x</span><span class="p">,</span> <span class="nx">y</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;number&#39;</span> <span class="o">!==</span> <span class="k">typeof</span> <span class="nx">x</span> <span class="o">||</span> <span class="nx">x</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="o">||</span> <span class="nb">isNaN</span><span class="p">(</span><span class="nx">x</span><span class="p">))</span> <span class="p">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nx">TypeError</span><span class="p">(</span><span class="s1">&#39;Roler.getId2RoleMatch: x must be a &#39;</span> <span class="o">+</span>
                                <span class="s1">&#39;non-negative number. Found: &#39;</span> <span class="o">+</span> <span class="nx">x</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;undefined&#39;</span> <span class="o">===</span> <span class="k">typeof</span> <span class="nx">y</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">id2RoleMatches</span><span class="p">[</span><span class="nx">x</span><span class="p">]</span> <span class="o">||</span> <span class="kc">null</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;number&#39;</span> <span class="o">!==</span> <span class="k">typeof</span> <span class="nx">y</span> <span class="o">||</span> <span class="nx">y</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="o">||</span> <span class="nb">isNaN</span><span class="p">(</span><span class="nx">y</span><span class="p">))</span> <span class="p">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nx">TypeError</span><span class="p">(</span><span class="s1">&#39;Roler.getId2RoleMatch: y must be a &#39;</span> <span class="o">+</span>
                                <span class="s1">&#39;non-negative number. Found: &#39;</span> <span class="o">+</span> <span class="nx">y</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">id2RoleMatches</span><span class="p">[</span><span class="nx">x</span><span class="p">][</span><span class="nx">y</span><span class="p">]</span> <span class="o">||</span> <span class="kc">null</span><span class="p">;</span>
    <span class="p">};</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="roler.getrole2idroundmap">
  <h3>
    <a href="#roler.getrole2idroundmap" name="roler.getrole2idroundmap" class="pilcrow">&#182;</a>
    Roler.getRole2IdRoundMap
  </h3>
</div>

  </div>
  <div class="body"><p>Returns the requested role to id/s mapping</p>
  </div>
  <div class="details">
    <div class="dox_tag_title">Params</div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">x</span>
      <span class="dox_type">number</span>
      <span>The round</span>
    </div>
    <div class="dox_tag_title">Returns</div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name"></span>
      <span class="dox_type">object</span>
      <span class="dox_type">null</span>
      <span>The role to id/s map or null
   if x is out of bounds</span>
    </div>
    <div class="dox_tag_title">See</div>
    <div class="dox_tag_detail">
      <span class="dox_type">Roler.role2IdRoundMap
</span>
    </div>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="nx">Roler</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">getRole2IdRoundMap</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">x</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;number&#39;</span> <span class="o">!==</span> <span class="k">typeof</span> <span class="nx">x</span> <span class="o">||</span> <span class="nx">x</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="o">||</span> <span class="nb">isNaN</span><span class="p">(</span><span class="nx">x</span><span class="p">))</span> <span class="p">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nx">TypeError</span><span class="p">(</span><span class="s1">&#39;Roler.getRole2IdRoundMap: x must be a &#39;</span> <span class="o">+</span>
                                <span class="s1">&#39;non-negative number. Found: &#39;</span> <span class="o">+</span> <span class="nx">x</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">role2IdRoundMap</span><span class="p">[</span><span class="nx">x</span><span class="p">]</span> <span class="o">||</span> <span class="kc">null</span><span class="p">;</span>
    <span class="p">};</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="roler.getid2roleroundmap">
  <h3>
    <a href="#roler.getid2roleroundmap" name="roler.getid2roleroundmap" class="pilcrow">&#182;</a>
    Roler.getId2RoleRoundMap
  </h3>
</div>

  </div>
  <div class="body"><p>Returns the requested id to role mapping</p>
  </div>
  <div class="details">
    <div class="dox_tag_title">Params</div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">x</span>
      <span class="dox_type">number</span>
      <span>The round</span>
    </div>
    <div class="dox_tag_title">Returns</div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name"></span>
      <span class="dox_type">object</span>
      <span class="dox_type">null</span>
      <span>The role-to-id map or null
   if x is out of bounds</span>
    </div>
    <div class="dox_tag_title">See</div>
    <div class="dox_tag_detail">
      <span class="dox_type">Roler.id2RoleRoundMap
</span>
    </div>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="nx">Roler</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">getId2RoleRoundMap</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">x</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;number&#39;</span> <span class="o">!==</span> <span class="k">typeof</span> <span class="nx">x</span> <span class="o">||</span> <span class="nx">x</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="o">||</span> <span class="nb">isNaN</span><span class="p">(</span><span class="nx">x</span><span class="p">))</span> <span class="p">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nx">TypeError</span><span class="p">(</span><span class="s1">&#39;Roler.getId2RoleRoundMap: x must be a &#39;</span> <span class="o">+</span>
                                <span class="s1">&#39;non-negative number. Found: &#39;</span> <span class="o">+</span> <span class="nx">x</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">id2RoleRoundMap</span><span class="p">[</span><span class="nx">x</span><span class="p">]</span> <span class="o">||</span> <span class="kc">null</span><span class="p">;</span>
    <span class="p">};</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap" id="rolify.">
  <h2>
    <a href="#rolify." name="rolify." class="pilcrow">&#182;</a>
    Rolify.
  </h2>
</div>

        </td>
        <td class="code highlight"><div class="highlight"><pre>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="roler.rolifyall">
  <h3>
    <a href="#roler.rolifyall" name="roler.rolifyall" class="pilcrow">&#182;</a>
    Roler.rolifyAll
  </h3>
</div>

  </div>
  <div class="body"><p>Applies roles to all matches</p>
  </div>
  <div class="details">
    <div class="dox_tag_title">Params</div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">Array</span>
      <span class="dox_type">array</span>
      <span>of array of matches</span>
    </div>
    <div class="dox_tag_title">Returns</div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name"></span>
      <span class="dox_type">array</span>
      <span>rolifiedMatches The full maps of roles</span>
    </div>
    <div class="dox_tag_title">See</div>
    <div class="dox_tag_detail">
      <span class="dox_type">Roler.rolifiedMatches</span>
    </div>
    <div class="dox_tag_title">See</div>
    <div class="dox_tag_detail">
      <span class="dox_type">Roler.role2IdMatches</span>
    </div>
    <div class="dox_tag_title">See</div>
    <div class="dox_tag_detail">
      <span class="dox_type">Roler.id2RoleMatches
</span>
    </div>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="nx">Roler</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">rolifyAll</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">matches</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">i</span><span class="p">,</span> <span class="nx">len</span><span class="p">,</span> <span class="nx">j</span><span class="p">,</span> <span class="nx">lenJ</span><span class="p">,</span> <span class="nx">row</span><span class="p">,</span> <span class="nx">rolifiedMatches</span><span class="p">;</span>
        <span class="kd">var</span> <span class="nx">r1</span><span class="p">,</span> <span class="nx">r2</span><span class="p">,</span> <span class="nx">rolesObj</span><span class="p">,</span> <span class="nx">idRolesObj</span><span class="p">;</span>

        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">J</span><span class="p">.</span><span class="nx">isArray</span><span class="p">(</span><span class="nx">matches</span><span class="p">)</span> <span class="o">||</span> <span class="o">!</span><span class="nx">matches</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="s1">&#39;Roler.rolifyAll: match must be a non empty &#39;</span> <span class="o">+</span>
                            <span class="s1">&#39;array. Found: &#39;</span> <span class="o">+</span> <span class="nx">matches</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="nx">i</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="nx">len</span> <span class="o">=</span> <span class="nx">matches</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
        <span class="nx">rolifiedMatches</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Array</span><span class="p">(</span><span class="nx">len</span><span class="p">);</span>
        <span class="nx">rolesObj</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Array</span><span class="p">(</span><span class="nx">len</span><span class="p">);</span>
        <span class="nx">idRolesObj</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Array</span><span class="p">(</span><span class="nx">len</span><span class="p">);</span>
        <span class="k">for</span> <span class="p">(</span> <span class="p">;</span> <span class="o">++</span><span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">len</span> <span class="p">;</span> <span class="p">)</span> <span class="p">{</span>
            <span class="nx">row</span> <span class="o">=</span> <span class="nx">matches</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
            <span class="nx">j</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="nx">lenJ</span> <span class="o">=</span> <span class="nx">row</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
            <span class="nx">rolifiedMatches</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Array</span><span class="p">(</span><span class="nx">lenJ</span><span class="p">);</span>
            <span class="nx">rolesObj</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Array</span><span class="p">(</span><span class="nx">lenJ</span><span class="p">);</span>
            <span class="nx">idRolesObj</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Array</span><span class="p">(</span><span class="nx">lenJ</span><span class="p">);</span>
            <span class="k">for</span> <span class="p">(</span> <span class="p">;</span> <span class="o">++</span><span class="nx">j</span> <span class="o">&lt;</span> <span class="nx">lenJ</span> <span class="p">;</span> <span class="p">)</span> <span class="p">{</span>
                <span class="nx">rolifiedMatches</span><span class="p">[</span><span class="nx">i</span><span class="p">][</span><span class="nx">j</span><span class="p">]</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">rolify</span><span class="p">(</span><span class="nx">row</span><span class="p">[</span><span class="nx">j</span><span class="p">],</span> <span class="nx">i</span><span class="p">,</span> <span class="nx">j</span><span class="p">);</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-43" id="section-43">&#182;</a>
</div>
<p>TODO: this code is repeated in Matcher.match, make it one!</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
                <span class="nx">r1</span> <span class="o">=</span> <span class="nx">rolifiedMatches</span><span class="p">[</span><span class="nx">i</span><span class="p">][</span><span class="nx">j</span><span class="p">][</span><span class="mi">0</span><span class="p">];</span>
                <span class="nx">r2</span> <span class="o">=</span> <span class="nx">rolifiedMatches</span><span class="p">[</span><span class="nx">i</span><span class="p">][</span><span class="nx">j</span><span class="p">][</span><span class="mi">1</span><span class="p">];</span>
                <span class="nx">rolesObj</span><span class="p">[</span><span class="nx">i</span><span class="p">][</span><span class="nx">j</span><span class="p">]</span> <span class="o">=</span> <span class="p">{};</span>
                <span class="k">if</span> <span class="p">(</span><span class="nx">r1</span> <span class="o">!==</span> <span class="nx">r2</span><span class="p">)</span> <span class="p">{</span>
                    <span class="nx">rolesObj</span><span class="p">[</span><span class="nx">i</span><span class="p">][</span><span class="nx">j</span><span class="p">][</span><span class="nx">r1</span><span class="p">]</span> <span class="o">=</span> <span class="nx">row</span><span class="p">[</span><span class="nx">j</span><span class="p">][</span><span class="mi">0</span><span class="p">];</span>
                    <span class="nx">rolesObj</span><span class="p">[</span><span class="nx">i</span><span class="p">][</span><span class="nx">j</span><span class="p">][</span><span class="nx">r2</span><span class="p">]</span> <span class="o">=</span> <span class="nx">row</span><span class="p">[</span><span class="nx">j</span><span class="p">][</span><span class="mi">1</span><span class="p">];</span>
                <span class="p">}</span>
                <span class="k">else</span> <span class="p">{</span>
                    <span class="nx">rolesObj</span><span class="p">[</span><span class="nx">i</span><span class="p">][</span><span class="nx">j</span><span class="p">][</span><span class="nx">r1</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span> <span class="nx">row</span><span class="p">[</span><span class="nx">j</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="nx">row</span><span class="p">[</span><span class="nx">j</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="p">];</span>
                <span class="p">}</span>
                <span class="nx">idRolesObj</span><span class="p">[</span><span class="nx">i</span><span class="p">][</span><span class="nx">j</span><span class="p">]</span> <span class="o">=</span> <span class="p">{};</span>
                <span class="nx">idRolesObj</span><span class="p">[</span><span class="nx">i</span><span class="p">][</span><span class="nx">j</span><span class="p">][</span><span class="nx">row</span><span class="p">[</span><span class="nx">j</span><span class="p">][</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="nx">r1</span><span class="p">;</span>
                <span class="nx">idRolesObj</span><span class="p">[</span><span class="nx">i</span><span class="p">][</span><span class="nx">j</span><span class="p">][</span><span class="nx">row</span><span class="p">[</span><span class="nx">j</span><span class="p">][</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="nx">r2</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">rolifiedMatches</span> <span class="o">=</span> <span class="nx">rolifiedMatches</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">role2IdMatches</span> <span class="o">=</span> <span class="nx">rolesObj</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">id2RoleMatches</span> <span class="o">=</span> <span class="nx">idRolesObj</span><span class="p">;</span>

        <span class="k">return</span> <span class="nx">rolifiedMatches</span><span class="p">;</span>
    <span class="p">};</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap" id="checkings.">
  <h2>
    <a href="#checkings." name="checkings." class="pilcrow">&#182;</a>
    Checkings.
  </h2>
</div>

        </td>
        <td class="code highlight"><div class="highlight"><pre>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="roler.roleexists">
  <h3>
    <a href="#roler.roleexists" name="roler.roleexists" class="pilcrow">&#182;</a>
    Roler.roleExists
  </h3>
</div>

  </div>
  <div class="body"><p>Returns TRUE if the requested role exists</p>
  </div>
  <div class="details">
    <div class="dox_tag_title">Params</div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">role</span>
      <span class="dox_type">string</span>
      <span>The role to check</span>
    </div>
    <div class="dox_tag_title">See</div>
    <div class="dox_tag_detail">
      <span class="dox_type">Roler.roles
</span>
    </div>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="nx">Roler</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">roleExists</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">role</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;string&#39;</span> <span class="o">!==</span> <span class="k">typeof</span> <span class="nx">role</span> <span class="o">||</span> <span class="nx">role</span><span class="p">.</span><span class="nx">trim</span><span class="p">()</span> <span class="o">===</span> <span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nx">TypeError</span><span class="p">(</span><span class="s1">&#39;Roler.roleExists: role must be &#39;</span> <span class="o">+</span>
                                <span class="s1">&#39;a non-empty string. Found: &#39;</span> <span class="o">+</span> <span class="nx">role</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="o">!!</span><span class="k">this</span><span class="p">.</span><span class="nx">roles</span><span class="p">[</span><span class="nx">role</span><span class="p">];</span>
    <span class="p">};</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="roler.hasrole">
  <h3>
    <a href="#roler.hasrole" name="roler.hasrole" class="pilcrow">&#182;</a>
    Roler.hasRole
  </h3>
</div>

  </div>
  <div class="body"><p>Returns TRUE if a given id is holding the specified role at round x</p>
  </div>
  <div class="details">
    <div class="dox_tag_title">Params</div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">id</span>
      <span class="dox_type">string</span>
      <span>The id to check</span>
    </div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">role</span>
      <span class="dox_type">string</span>
      <span>The role to check</span>
    </div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">x</span>
      <span class="dox_type">number</span>
      <span>The round to check</span>
    </div>
    <div class="dox_tag_title">Returns</div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name"></span>
      <span class="dox_type">boolean</span>
      <span>True if id has given role</span>
    </div>
    <div class="dox_tag_title">See</div>
    <div class="dox_tag_detail">
      <span class="dox_type">Roler.id2RoleRoundMap
</span>
    </div>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="nx">Roler</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">hasRole</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">id</span><span class="p">,</span> <span class="nx">role</span><span class="p">,</span> <span class="nx">x</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;string&#39;</span> <span class="o">!==</span> <span class="k">typeof</span> <span class="nx">id</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nx">TypeError</span><span class="p">(</span><span class="s1">&#39;Roler.hasRole: id must be string. Found: &#39;</span> <span class="o">+</span>
                                <span class="nx">id</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;string&#39;</span> <span class="o">!==</span> <span class="k">typeof</span> <span class="nx">role</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nx">TypeError</span><span class="p">(</span><span class="s1">&#39;Roler.hasRole: role must be string. Found: &#39;</span> <span class="o">+</span>
                                <span class="nx">role</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;number&#39;</span> <span class="o">!==</span> <span class="k">typeof</span> <span class="nx">x</span> <span class="o">||</span> <span class="nx">x</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="o">||</span> <span class="nb">isNaN</span><span class="p">(</span><span class="nx">x</span><span class="p">))</span> <span class="p">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nx">TypeError</span><span class="p">(</span><span class="s1">&#39;Roler.hasRole: x must be a non-negative &#39;</span> <span class="o">+</span>
                                <span class="s1">&#39;number. Found: &#39;</span> <span class="o">+</span> <span class="nx">x</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">id2RoleRoundMap</span><span class="p">[</span><span class="nx">x</span><span class="p">][</span><span class="nx">id</span><span class="p">]</span> <span class="o">===</span> <span class="nx">role</span><span class="p">;</span>
    <span class="p">};</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap" id="edit%2Freplace.">
  <h2>
    <a href="#edit%2Freplace." name="edit%2Freplace." class="pilcrow">&#182;</a>
    Edit/Replace.
  </h2>
</div>

        </td>
        <td class="code highlight"><div class="highlight"><pre>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="roler.replaceid">
  <h3>
    <a href="#roler.replaceid" name="roler.replaceid" class="pilcrow">&#182;</a>
    Roler.replaceId
  </h3>
</div>

  </div>
  <div class="body"><p>Replaces an id with a new one in all roles</p>
  </div>
  <div class="details">
    <div class="dox_tag_title">Params</div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">oldId</span>
      <span class="dox_type">string</span>
      <span>The id to be replaced</span>
    </div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">newId</span>
      <span class="dox_type">string</span>
      <span>The replacing id</span>
    </div>
    <div class="dox_tag_title">Returns</div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name"></span>
      <span class="dox_type">boolean</span>
      <span>TRUE, if the oldId was found and replaced</span>
    </div>
    <div class="dox_tag_title">See</div>
    <div class="dox_tag_detail">
      <span class="dox_type">MatcherManager.replaceId</span>
    </div>
    <div class="dox_tag_title">See</div>
    <div class="dox_tag_detail">
      <span class="dox_type">Matcher.replaceId
</span>
    </div>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="nx">Roler</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">replaceId</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">oldId</span><span class="p">,</span> <span class="nx">newId</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">m</span><span class="p">,</span> <span class="nx">n</span><span class="p">;</span>
        <span class="kd">var</span> <span class="nx">i</span><span class="p">,</span> <span class="nx">len</span><span class="p">,</span> <span class="nx">j</span><span class="p">,</span> <span class="nx">lenJ</span><span class="p">,</span> <span class="nx">h</span><span class="p">,</span> <span class="nx">lenH</span><span class="p">,</span> <span class="nx">k</span><span class="p">,</span> <span class="nx">lenK</span><span class="p">;</span>
        <span class="kd">var</span> <span class="nx">rowFound</span><span class="p">;</span>
        <span class="kd">var</span> <span class="nx">tmp</span><span class="p">,</span> <span class="nx">role</span><span class="p">;</span>

        <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;string&#39;</span> <span class="o">!==</span> <span class="k">typeof</span> <span class="nx">oldId</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nx">TypeError</span><span class="p">(</span><span class="s1">&#39;Roler.replaceId: oldId should be string. &#39;</span> <span class="o">+</span>
                                <span class="s1">&#39;Found: &#39;</span> <span class="o">+</span> <span class="nx">oldId</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;string&#39;</span> <span class="o">!==</span> <span class="k">typeof</span> <span class="nx">newId</span> <span class="o">&amp;&amp;</span> <span class="nx">newId</span><span class="p">.</span><span class="nx">trim</span><span class="p">()</span> <span class="o">!==</span> <span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nx">TypeError</span><span class="p">(</span><span class="s1">&#39;Roler.replaceId: newId should be a &#39;</span> <span class="o">+</span>
                                <span class="s1">&#39;non-empty string. Found: &#39;</span> <span class="o">+</span> <span class="nx">newId</span><span class="p">);</span>
        <span class="p">}</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-49" id="section-49">&#182;</a>
</div>
<p>No id was assigned yet.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">id2RoleMatches</span><span class="p">)</span> <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-50" id="section-50">&#182;</a>
</div>
<p>Update id2RoleMatches and role2IdMatches at the same time.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="nx">m</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">id2RoleMatches</span><span class="p">;</span>
        <span class="nx">n</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">role2IdMatches</span><span class="p">;</span>

        <span class="nx">i</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="nx">len</span> <span class="o">=</span> <span class="nx">m</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
        <span class="k">for</span> <span class="p">(</span> <span class="p">;</span> <span class="o">++</span><span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">len</span> <span class="p">;</span> <span class="p">)</span> <span class="p">{</span>
            <span class="nx">j</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="nx">lenJ</span> <span class="o">=</span> <span class="nx">m</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">length</span><span class="p">;</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-51" id="section-51">&#182;</a>
</div>
<p>If it was not found in the previous row, return FALSE.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
            <span class="k">if</span> <span class="p">(</span><span class="nx">j</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nx">rowFound</span><span class="p">)</span> <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
            <span class="k">for</span> <span class="p">(</span> <span class="p">;</span> <span class="o">++</span><span class="nx">j</span> <span class="o">&lt;</span> <span class="nx">lenJ</span> <span class="p">;</span> <span class="p">)</span> <span class="p">{</span>
                <span class="nx">rowFound</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
                <span class="k">for</span> <span class="p">(</span><span class="nx">h</span> <span class="k">in</span> <span class="nx">m</span><span class="p">[</span><span class="nx">i</span><span class="p">][</span><span class="nx">j</span><span class="p">])</span> <span class="p">{</span>
                    <span class="k">if</span> <span class="p">(</span><span class="nx">m</span><span class="p">[</span><span class="nx">i</span><span class="p">][</span><span class="nx">j</span><span class="p">].</span><span class="nx">hasOwnProperty</span><span class="p">(</span><span class="nx">h</span><span class="p">))</span> <span class="p">{</span>
                        <span class="k">if</span> <span class="p">(</span><span class="nx">h</span> <span class="o">===</span> <span class="nx">oldId</span><span class="p">)</span> <span class="p">{</span>
                            <span class="nx">role</span> <span class="o">=</span> <span class="nx">m</span><span class="p">[</span><span class="nx">i</span><span class="p">][</span><span class="nx">j</span><span class="p">][</span><span class="nx">oldId</span><span class="p">];</span>
                            <span class="nx">m</span><span class="p">[</span><span class="nx">i</span><span class="p">][</span><span class="nx">j</span><span class="p">][</span><span class="nx">newId</span><span class="p">]</span> <span class="o">=</span> <span class="nx">role</span><span class="p">;</span>
                            <span class="k">delete</span> <span class="nx">m</span><span class="p">[</span><span class="nx">i</span><span class="p">][</span><span class="nx">j</span><span class="p">][</span><span class="nx">oldId</span><span class="p">];</span>
                            <span class="nx">rowFound</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-52" id="section-52">&#182;</a>
</div>
<p>All ids in match with same role.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
                            <span class="nx">tmp</span> <span class="o">=</span> <span class="nx">n</span><span class="p">[</span><span class="nx">i</span><span class="p">][</span><span class="nx">j</span><span class="p">][</span><span class="nx">role</span><span class="p">];</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-53" id="section-53">&#182;</a>
</div>
<p>If it is an array, try to optimize replacement.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
                            <span class="k">if</span> <span class="p">(</span><span class="nx">J</span><span class="p">.</span><span class="nx">isArray</span><span class="p">(</span><span class="nx">tmp</span><span class="p">))</span> <span class="p">{</span>
                                <span class="nx">lenK</span> <span class="o">=</span> <span class="nx">tmp</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
                                <span class="k">if</span> <span class="p">(</span><span class="nx">lenK</span> <span class="o">===</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
                                    <span class="nx">tmp</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="nx">newId</span><span class="p">;</span>
                                <span class="p">}</span>
                                <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">lenK</span> <span class="o">===</span> <span class="mi">2</span><span class="p">)</span> <span class="p">{</span>
                                    <span class="k">if</span> <span class="p">(</span><span class="nx">tmp</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">===</span> <span class="nx">oldId</span><span class="p">)</span> <span class="nx">tmp</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="nx">newId</span><span class="p">;</span>
                                    <span class="k">else</span> <span class="nx">tmp</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="nx">newId</span><span class="p">;</span>
                                <span class="p">}</span>
                                <span class="k">else</span> <span class="p">{</span>
                                    <span class="nx">k</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
                                    <span class="k">for</span> <span class="p">(</span> <span class="p">;</span> <span class="o">++</span><span class="nx">k</span> <span class="o">&lt;</span> <span class="nx">lenK</span> <span class="p">;</span> <span class="p">)</span> <span class="p">{</span>
                                        <span class="k">if</span> <span class="p">(</span><span class="nx">tmp</span><span class="p">[</span><span class="nx">k</span><span class="p">]</span> <span class="o">===</span> <span class="nx">oldId</span><span class="p">)</span> <span class="p">{</span>
                                            <span class="nx">tmp</span><span class="p">[</span><span class="nx">k</span><span class="p">]</span> <span class="o">=</span> <span class="nx">newId</span><span class="p">;</span>
                                            <span class="k">break</span><span class="p">;</span>
                                        <span class="p">}</span>
                                    <span class="p">}</span>
                                <span class="p">}</span>
                            <span class="p">}</span>
                            <span class="k">else</span> <span class="p">{</span>
                                <span class="nx">n</span><span class="p">[</span><span class="nx">i</span><span class="p">][</span><span class="nx">j</span><span class="p">][</span><span class="nx">role</span><span class="p">]</span> <span class="o">=</span> <span class="nx">newId</span><span class="p">;</span>
                            <span class="p">}</span>

                            <span class="k">break</span><span class="p">;</span>
                        <span class="p">}</span>
                    <span class="p">}</span>
                <span class="p">}</span>
                <span class="k">if</span> <span class="p">(</span><span class="nx">rowFound</span><span class="p">)</span> <span class="k">break</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-54" id="section-54">&#182;</a>
</div>
<p>Update id2RoleRoundMap and role2IdRoundMap at the same time.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="nx">m</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">id2RoleRoundMap</span><span class="p">;</span>
        <span class="nx">n</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">role2IdRoundMap</span><span class="p">;</span>

        <span class="nx">i</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="nx">len</span> <span class="o">=</span> <span class="nx">m</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
        <span class="k">for</span> <span class="p">(</span> <span class="p">;</span> <span class="o">++</span><span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">len</span> <span class="p">;</span> <span class="p">)</span> <span class="p">{</span>
            <span class="nx">rowFound</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
            <span class="k">for</span> <span class="p">(</span><span class="nx">j</span> <span class="k">in</span> <span class="nx">m</span><span class="p">[</span><span class="nx">i</span><span class="p">])</span> <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span><span class="nx">m</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">hasOwnProperty</span><span class="p">(</span><span class="nx">j</span><span class="p">))</span> <span class="p">{</span>
                    <span class="k">if</span> <span class="p">(</span><span class="nx">j</span> <span class="o">===</span> <span class="nx">oldId</span><span class="p">)</span> <span class="p">{</span>
                        <span class="nx">m</span><span class="p">[</span><span class="nx">i</span><span class="p">][</span><span class="nx">newId</span><span class="p">]</span> <span class="o">=</span> <span class="nx">m</span><span class="p">[</span><span class="nx">i</span><span class="p">][</span><span class="nx">oldId</span><span class="p">];</span>
                        <span class="k">delete</span> <span class="nx">m</span><span class="p">[</span><span class="nx">i</span><span class="p">][</span><span class="nx">oldId</span><span class="p">];</span>
                        <span class="nx">rowFound</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-55" id="section-55">&#182;</a>
</div>
<p>All ids with same role at same round.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
                        <span class="nx">tmp</span> <span class="o">=</span> <span class="nx">n</span><span class="p">[</span><span class="nx">i</span><span class="p">][</span><span class="nx">m</span><span class="p">[</span><span class="nx">i</span><span class="p">][</span><span class="nx">newId</span><span class="p">]];</span>

                        <span class="nx">lenH</span> <span class="o">=</span> <span class="nx">tmp</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
                        <span class="k">if</span> <span class="p">(</span><span class="nx">lenH</span> <span class="o">===</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
                            <span class="nx">tmp</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="nx">newId</span><span class="p">;</span>
                        <span class="p">}</span>
                        <span class="k">else</span> <span class="p">{</span>
                            <span class="nx">h</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
                            <span class="k">for</span> <span class="p">(</span> <span class="p">;</span> <span class="o">++</span><span class="nx">h</span> <span class="o">&lt;</span> <span class="nx">len</span> <span class="p">;</span> <span class="p">)</span> <span class="p">{</span>
                                <span class="k">if</span> <span class="p">(</span><span class="nx">tmp</span><span class="p">[</span><span class="nx">h</span><span class="p">]</span> <span class="o">===</span> <span class="nx">oldId</span><span class="p">)</span> <span class="p">{</span>
                                    <span class="nx">tmp</span><span class="p">[</span><span class="nx">h</span><span class="p">]</span> <span class="o">=</span> <span class="nx">newId</span><span class="p">;</span>
                                    <span class="k">break</span><span class="p">;</span>
                                <span class="p">}</span>
                            <span class="p">}</span>
                        <span class="p">}</span>

                    <span class="p">}</span>
                <span class="p">}</span>
                <span class="k">if</span> <span class="p">(</span><span class="nx">rowFound</span><span class="p">)</span> <span class="k">break</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
    <span class="p">};</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap" id="helper%20methods.">
  <h2>
    <a href="#helper%20methods." name="helper%20methods." class="pilcrow">&#182;</a>
    Helper methods.
  </h2>
</div>

        </td>
        <td class="code highlight"><div class="highlight"><pre>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="validateroleidmatches">
  <h3>
    <a href="#validateroleidmatches" name="validateroleidmatches" class="pilcrow">&#182;</a>
    validateRoleIdMatches
  </h3>
</div>

  </div>
  <div class="body"><p>Deep validates role-id or id-role matches (object type), throws errors</p>

<p>Validation:</p>

<ul>
<li>The map is an array of objects
<ul><li>Each object must have two info-items.</li>
<li>An info-item can contain:
a) 2 keys-valus pairs (id-role|role-id), or
b) an array of length 2 (role: id1, id2) [allowed only if
invoking method is 'setRole2IdMatches']</li></ul></li>
</ul>
  </div>
  <div class="details">
    <div class="dox_tag_title">Params</div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">method</span>
      <span class="dox_type">string</span>
      <span>The name of the method invoking validation</span>
    </div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">matches</span>
      <span class="dox_type">array</span>
      <span>The matches to validate</span>
    </div>
    <div class="dox_tag_title">See</div>
    <div class="dox_tag_detail">
      <span class="dox_type">validString</span>
    </div>
    <div class="dox_tag_title">See</div>
    <div class="dox_tag_detail">
      <span class="dox_type">setRole2IdMatches</span>
    </div>
    <div class="dox_tag_title">See</div>
    <div class="dox_tag_detail">
      <span class="dox_type">setId2RoleMatches
</span>
    </div>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">function</span> <span class="nx">validateRoleIdMatches</span><span class="p">(</span><span class="nx">method</span><span class="p">,</span> <span class="nx">matches</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">i</span><span class="p">,</span> <span class="nx">len</span><span class="p">;</span>
        <span class="kd">var</span> <span class="nx">j</span><span class="p">,</span> <span class="nx">lenJ</span><span class="p">;</span>
        <span class="kd">var</span> <span class="nx">k</span><span class="p">,</span> <span class="nx">nKeys</span><span class="p">;</span>
        <span class="kd">var</span> <span class="nx">arrayOk</span><span class="p">,</span> <span class="nx">elem</span><span class="p">,</span> <span class="nx">isArray</span><span class="p">;</span>

        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">J</span><span class="p">.</span><span class="nx">isArray</span><span class="p">(</span><span class="nx">matches</span><span class="p">)</span> <span class="o">||</span> <span class="o">!</span><span class="nx">matches</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="s1">&#39;Roler.&#39;</span> <span class="o">+</span> <span class="nx">method</span> <span class="o">+</span> <span class="s1">&#39;: matches must be a &#39;</span> <span class="o">+</span>
                            <span class="s1">&#39;non-empty array. Found: &#39;</span> <span class="o">+</span> <span class="nx">matches</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="nx">arrayOk</span> <span class="o">=</span> <span class="p">(</span><span class="nx">method</span> <span class="o">===</span> <span class="s1">&#39;setRole2IdMatches&#39;</span><span class="p">)</span> <span class="o">?</span> <span class="kc">true</span> <span class="o">:</span> <span class="kc">false</span><span class="p">;</span>
        <span class="nx">i</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="nx">len</span> <span class="o">=</span> <span class="nx">matches</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
        <span class="k">for</span> <span class="p">(</span> <span class="p">;</span> <span class="o">++</span><span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">len</span> <span class="p">;</span> <span class="p">)</span> <span class="p">{</span>
            <span class="nx">i</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="nx">lenJ</span> <span class="o">=</span> <span class="nx">matches</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">length</span><span class="p">;</span>
            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">lenJ</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="s1">&#39;Roler.&#39;</span> <span class="o">+</span> <span class="nx">method</span> <span class="o">+</span> <span class="s1">&#39;: matches round &#39;</span> <span class="o">+</span>
                                <span class="nx">i</span> <span class="o">+</span> <span class="s1">&#39;has no elements.&#39;</span><span class="p">);</span>
            <span class="p">}</span>
            <span class="k">for</span> <span class="p">(</span> <span class="p">;</span> <span class="o">++</span><span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">lenJ</span> <span class="p">;</span> <span class="p">)</span> <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;object&#39;</span> <span class="o">!==</span> <span class="k">typeof</span> <span class="nx">matches</span><span class="p">[</span><span class="nx">i</span><span class="p">][</span><span class="nx">j</span><span class="p">])</span> <span class="p">{</span>
                    <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="s1">&#39;Roler.&#39;</span> <span class="o">+</span> <span class="nx">method</span> <span class="o">+</span> <span class="s1">&#39;: matches &#39;</span> <span class="o">+</span>
                                    <span class="s1">&#39;round &#39;</span> <span class="o">+</span> <span class="nx">i</span> <span class="o">+</span> <span class="s1">&#39; element &#39;</span> <span class="o">+</span> <span class="nx">j</span> <span class="o">+</span>
                                    <span class="s1">&#39; should be object. Found: &#39;</span> <span class="o">+</span>
                                    <span class="nx">matches</span><span class="p">[</span><span class="nx">i</span><span class="p">][</span><span class="nx">j</span><span class="p">]);</span>
                <span class="p">}</span>

                <span class="nx">nKeys</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
                <span class="nx">isArray</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
                <span class="k">for</span> <span class="p">(</span><span class="nx">k</span> <span class="k">in</span> <span class="nx">matches</span><span class="p">[</span><span class="nx">i</span><span class="p">][</span><span class="nx">j</span><span class="p">])</span> <span class="p">{</span>
                    <span class="k">if</span> <span class="p">(</span><span class="nx">matches</span><span class="p">[</span><span class="nx">i</span><span class="p">][</span><span class="nx">j</span><span class="p">].</span><span class="nx">hasOwnProperty</span><span class="p">(</span><span class="nx">k</span><span class="p">))</span> <span class="p">{</span>
                        <span class="nx">nKeys</span><span class="o">++</span><span class="p">;</span>
                        <span class="k">if</span> <span class="p">(</span><span class="nx">k</span><span class="p">.</span><span class="nx">trim</span><span class="p">()</span> <span class="o">===</span> <span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="p">{</span>
                            <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="s1">&#39;Roler.&#39;</span> <span class="o">+</span> <span class="nx">method</span> <span class="o">+</span> <span class="s1">&#39;: &#39;</span> <span class="o">+</span>
                                            <span class="s1">&#39;roles matches (&#39;</span> <span class="o">+</span> <span class="nx">i</span> <span class="o">+</span> <span class="s1">&#39;,&#39;</span> <span class="o">+</span> <span class="nx">j</span> <span class="o">+</span>
                                            <span class="s1">&#39;) has invalid key: &#39;</span> <span class="o">+</span> <span class="nx">k</span><span class="p">);</span>
                        <span class="p">}</span>
                        <span class="nx">elem</span> <span class="o">=</span> <span class="nx">matches</span><span class="p">[</span><span class="nx">i</span><span class="p">][</span><span class="nx">j</span><span class="p">][</span><span class="nx">k</span><span class="p">];</span>
                        <span class="k">if</span> <span class="p">(</span><span class="nx">arrayOk</span> <span class="o">&amp;&amp;</span> <span class="nx">J</span><span class="p">.</span><span class="nx">isArray</span><span class="p">(</span><span class="nx">elem</span><span class="p">))</span> <span class="p">{</span>
                            <span class="nx">isArray</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
                            <span class="k">if</span> <span class="p">(</span><span class="nx">elem</span><span class="p">.</span><span class="nx">length</span> <span class="o">!==</span> <span class="mi">2</span><span class="p">)</span> <span class="p">{</span>
                                <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="s1">&#39;Roler.&#39;</span> <span class="o">+</span> <span class="nx">method</span> <span class="o">+</span> <span class="s1">&#39;: &#39;</span> <span class="o">+</span>
                                                <span class="s1">&#39;roles matches (&#39;</span> <span class="o">+</span> <span class="nx">i</span> <span class="o">+</span> <span class="s1">&#39;,&#39;</span> <span class="o">+</span>
                                                <span class="nx">j</span> <span class="o">+</span> <span class="s1">&#39;, &#39;</span> <span class="o">+</span> <span class="nx">k</span> <span class="o">+</span> <span class="s1">&#39;) has &#39;</span> <span class="o">+</span>
                                                <span class="s1">&#39;invalid length: &#39;</span> <span class="o">+</span> <span class="nx">elem</span><span class="p">);</span>
                            <span class="p">}</span>
                            <span class="nx">validString</span><span class="p">(</span><span class="nx">method</span><span class="p">,</span> <span class="nx">elem</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nx">i</span><span class="p">,</span> <span class="nx">j</span><span class="p">,</span> <span class="nx">k</span><span class="p">);</span>
                            <span class="nx">validString</span><span class="p">(</span><span class="nx">method</span><span class="p">,</span> <span class="nx">elem</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="nx">i</span><span class="p">,</span> <span class="nx">j</span><span class="p">,</span> <span class="nx">k</span><span class="p">);</span>
                        <span class="p">}</span>
                        <span class="k">else</span> <span class="p">{</span>
                            <span class="nx">validString</span><span class="p">(</span><span class="nx">method</span><span class="p">,</span> <span class="nx">elem</span><span class="p">,</span> <span class="nx">i</span><span class="p">,</span> <span class="nx">j</span><span class="p">,</span> <span class="nx">k</span><span class="p">);</span>
                        <span class="p">}</span>
                    <span class="p">}</span>
                <span class="p">}</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-58" id="section-58">&#182;</a>
</div>
<p>These are specific to the rolify cb.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
                <span class="k">if</span> <span class="p">((</span><span class="nx">isArray</span> <span class="o">&amp;&amp;</span> <span class="nx">nKeys</span> <span class="o">!==</span> <span class="mi">1</span><span class="p">)</span> <span class="o">||</span> <span class="p">(</span><span class="o">!</span><span class="nx">isArray</span> <span class="o">&amp;&amp;</span> <span class="nx">nKeys</span> <span class="o">!==</span> <span class="mi">2</span><span class="p">))</span> <span class="p">{</span>
                    <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="s1">&#39;Roler.&#39;</span> <span class="o">+</span> <span class="nx">method</span> <span class="o">+</span> <span class="s1">&#39;: roles matches (&#39;</span> <span class="o">+</span>
                                    <span class="nx">i</span> <span class="o">+</span> <span class="s1">&#39;,&#39;</span> <span class="o">+</span> <span class="nx">j</span> <span class="o">+</span> <span class="s1">&#39;) was expected to have &#39;</span> <span class="o">+</span>
                                    <span class="s1">&#39;2 elements in total. Found: &#39;</span> <span class="o">+</span>
                                    <span class="nx">matches</span><span class="p">[</span><span class="nx">i</span><span class="p">][</span><span class="nx">j</span><span class="p">]);</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="validstring">
  <h3>
    <a href="#validstring" name="validstring" class="pilcrow">&#182;</a>
    validString
  </h3>
</div>

  </div>
  <div class="body"><p>Validates the content of role/id or id/role match, throws errors</p>
  </div>
  <div class="details">
    <div class="dox_tag_title">Params</div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">method</span>
      <span class="dox_type">string</span>
      <span>The name of the method invoking validation</span>
    </div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">elem</span>
      <span class="dox_type">mixed</span>
      <span>The element to validate (should
   be non-empty string: id or role)</span>
    </div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">i</span>
      <span class="dox_type">number</span>
      <span>The i-th round in the matches array</span>
    </div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">j</span>
      <span class="dox_type">number</span>
      <span>The j-th match at round i-th in the matches array</span>
    </div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">k</span>
      <span class="dox_type">string</span>
      <span>The name of the key containig mapping to elem</span>
    </div>
    <div class="dox_tag_title">See</div>
    <div class="dox_tag_detail">
      <span class="dox_type">validString
</span>
    </div>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">function</span> <span class="nx">validString</span><span class="p">(</span><span class="nx">method</span><span class="p">,</span> <span class="nx">elem</span><span class="p">,</span> <span class="nx">i</span><span class="p">,</span> <span class="nx">j</span><span class="p">,</span> <span class="nx">k</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;string&#39;</span> <span class="o">!==</span> <span class="k">typeof</span> <span class="nx">elem</span> <span class="o">||</span> <span class="nx">elem</span><span class="p">.</span><span class="nx">trim</span><span class="p">()</span> <span class="o">===</span> <span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="s1">&#39;Roler.&#39;</span> <span class="o">+</span> <span class="nx">method</span> <span class="o">+</span> <span class="s1">&#39;: roles map (&#39;</span> <span class="o">+</span> <span class="nx">i</span> <span class="o">+</span> <span class="s1">&#39;,&#39;</span> <span class="o">+</span> <span class="nx">j</span> <span class="o">+</span>
                            <span class="s1">&#39;,&#39;</span> <span class="o">+</span> <span class="nx">k</span> <span class="o">+</span><span class="s1">&#39;) has invalid elements: &#39;</span> <span class="o">+</span> <span class="nx">elem</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap" id="closure">
  <h2>
    <a href="#closure" name="closure" class="pilcrow">&#182;</a>
    Closure
  </h2>
</div>

        </td>
        <td class="code highlight"><div class="highlight"><pre>
<span class="p">})(</span>
    <span class="s1">&#39;undefined&#39;</span> <span class="o">!==</span> <span class="k">typeof</span> <span class="nx">node</span> <span class="o">?</span> <span class="nx">node</span> <span class="o">:</span> <span class="nx">module</span><span class="p">.</span><span class="nx">exports</span><span class="p">,</span>
    <span class="s1">&#39;undefined&#39;</span> <span class="o">!==</span> <span class="k">typeof</span> <span class="nx">node</span> <span class="o">?</span> <span class="nx">node</span> <span class="o">:</span> <span class="nx">module</span><span class="p">.</span><span class="nx">parent</span><span class="p">.</span><span class="nx">exports</span>
<span class="p">);</span>
</pre></div>
        </td>
      </tr>
  </tbody>
</table>
  </div>
</body>
</html>
