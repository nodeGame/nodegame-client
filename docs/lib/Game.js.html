<!DOCTYPE html>
<html>
<head>
  <title>Game.js</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <link rel="stylesheet" media="all" href="../doc-style.css" />
  <script src="../doc-filelist.js"></script>
  <script>
    var relativeDir = '../', thisFile = 'lib/Game.js', defaultSidebar = true;
  </script>
  <script src="../doc-script.js"></script>
</head>
<body>
  <div id="sidebar_wrapper">
    <div id="sidebar_switch">
      <span class="tree">Files</span>
      <span class="headings">Headings</span>
    </div>
    <div id="tree"></div>
    <div id="headings">
      <div class="heading h1">
        <a href="#game">Game</a>
      </div>
      <div class="heading h2">
        <a href="#global-scope">Global scope</a>
      </div>
      <div class="heading h2">
        <a href="#game-constructor">Game constructor</a>
      </div>
      <div class="heading h2">
        <a href="#private-properties">Private properties</a>
      </div>
      <div class="heading h3">
        <a href="#game.name">Game.name</a>
      </div>
      <div class="heading h3">
        <a href="#game.description">Game.description</a>
      </div>
      <div class="heading h3">
        <a href="#game.gameloop">Game.gameLoop</a>
      </div>
      <div class="heading h3">
        <a href="#game.pl">Game.pl</a>
      </div>
      <div class="heading h3">
        <a href="#game.pl">Game.pl</a>
      </div>
      <div class="heading h3">
        <a href="#game.ready">Game.ready</a>
      </div>
      <div class="heading h2">
        <a href="#public-properties">Public properties</a>
      </div>
      <div class="heading h3">
        <a href="#game.observer">Game.observer</a>
      </div>
      <div class="heading h3">
        <a href="#game.auto_step">Game.auto_step</a>
      </div>
      <div class="heading h3">
        <a href="#game.auto_wait">Game.auto_wait</a>
      </div>
      <div class="heading h3">
        <a href="#game.solo_mode">Game.solo_mode</a>
      </div>
      <div class="heading h3">
        <a href="#game.memory">Game.memory</a>
      </div>
      <div class="heading h2">
        <a href="#game-methods">Game methods</a>
      </div>
      <div class="heading h3">
        <a href="#game.init">Game.init</a>
      </div>
      <div class="heading h3">
        <a href="#game.pause">Game.pause</a>
      </div>
      <div class="heading h3">
        <a href="#game.resume">Game.resume</a>
      </div>
      <div class="heading h3">
        <a href="#game.next">Game.next</a>
      </div>
      <div class="heading h3">
        <a href="#game.previous">Game.previous</a>
      </div>
      <div class="heading h3">
        <a href="#game.jumpto">Game.jumpTo</a>
      </div>
      <div class="heading h3">
        <a href="#game.publishstate">Game.publishState</a>
      </div>
      <div class="heading h3">
        <a href="#game.updatestate">Game.updateState</a>
      </div>
      <div class="heading h3">
        <a href="#game.step">Game.step</a>
      </div>
      <div class="heading h3">
        <a href="#game.isready">Game.isReady</a>
      </div>
      <div class="heading h2">
        <a href="#closure">Closure</a>
      </div>
    </div>
  </div>
  <div id="sidebar-toggle"></div>
  <div id="container"><div class="background highlight"></div>
<table cellpadding="0" cellspacing="0">
  <tbody>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="game">
  <h1>
    <a href="#game" class="pilcrow">&#182;</a>
    Game
  </h1>
</div>

  </div>
  <div class="body"><p>Copyright(c) 2012 Stefano Balietti
MIT Licensed </p>

<p>Wrapper class for a <code>GameLoop</code> object and functions to control the game flow</p>

<p>Defines a number of event listeners, diveded in</p>

<ul>
<li>incoming,</li>
<li>outgoing,</li>
<li>internal </li>
</ul>

<hr />
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>  
<span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">exports</span><span class="p">,</span> <span class="nx">node</span><span class="p">)</span> <span class="p">{</span>
  </pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap" id="global-scope">
  <h2>
    <a href="#global-scope" class="pilcrow">&#182;</a>
    Global scope
  </h2>
</div>

        </td>
        <td class="code highlight"><div class="highlight"><pre>  
<span class="kd">var</span> <span class="nx">GameState</span> <span class="o">=</span> <span class="nx">node</span><span class="p">.</span><span class="nx">GameState</span><span class="p">,</span>
  <span class="nx">GameMsg</span> <span class="o">=</span> <span class="nx">node</span><span class="p">.</span><span class="nx">GameMsg</span><span class="p">,</span>
  <span class="nx">GameDB</span> <span class="o">=</span> <span class="nx">node</span><span class="p">.</span><span class="nx">GameDB</span><span class="p">,</span>
  <span class="nx">PlayerList</span> <span class="o">=</span> <span class="nx">node</span><span class="p">.</span><span class="nx">PlayerList</span><span class="p">,</span>
  <span class="nx">Player</span> <span class="o">=</span> <span class="nx">node</span><span class="p">.</span><span class="nx">Player</span><span class="p">,</span>
  <span class="nx">GameLoop</span> <span class="o">=</span> <span class="nx">node</span><span class="p">.</span><span class="nx">GameLoop</span><span class="p">,</span>
  <span class="nx">JSUS</span> <span class="o">=</span> <span class="nx">node</span><span class="p">.</span><span class="nx">JSUS</span><span class="p">;</span>


<span class="nx">exports</span><span class="p">.</span><span class="nx">Game</span> <span class="o">=</span> <span class="nx">Game</span><span class="p">;</span>

<span class="kd">var</span> <span class="nx">name</span><span class="p">,</span>
  <span class="nx">description</span><span class="p">,</span>
  <span class="nx">gameLoop</span><span class="p">,</span>
  <span class="nx">pl</span><span class="p">,</span>
  <span class="nx">ml</span><span class="p">;</span>
  </pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="game-constructor">
  <h2>
    <a href="#game-constructor" class="pilcrow">&#182;</a>
    Game constructor
  </h2>
</div>

  </div>
  <div class="body"><p>Creates a new instance of Game</p>
  </div>
  <div class="details">
    <div class="dox_tag_title">Params</div>
    <div class="dox_tag_detail">
      <span>settings</span>
      <span class="dox_type">object</span>
      <span>Optional. A configuration object</span>
    </div>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre><span class="kd">function</span> <span class="nx">Game</span> <span class="p">(</span><span class="nx">settings</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">settings</span> <span class="o">=</span> <span class="nx">settings</span> <span class="o">||</span> <span class="p">{};</span></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap" id="private-properties">
  <h2>
    <a href="#private-properties" class="pilcrow">&#182;</a>
    Private properties
  </h2>
</div>

        </td>
        <td class="code highlight"><div class="highlight"><pre></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="game.name">
  <h3>
    <a href="#game.name" class="pilcrow">&#182;</a>
    Game.name
  </h3>
</div>

  </div>
  <div class="body"><p>The name of the game</p>
  </div>
  <div class="details">
    <div class="dox_tag_title">API</div>
    <div class="dox_tag_detail">
      <span class="dox_type">private</span>
    </span>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>  <span class="nx">name</span> <span class="o">=</span> <span class="nx">settings</span><span class="p">.</span><span class="nx">name</span> <span class="o">||</span> <span class="s1">&#39;A nodeGame game&#39;</span><span class="p">;</span>
  
  <span class="k">if</span> <span class="p">(</span><span class="nx">node</span><span class="p">.</span><span class="nx">support</span><span class="p">.</span><span class="nx">defineProperty</span><span class="p">)</span> <span class="p">{</span>
    <span class="nb">Object</span><span class="p">.</span><span class="nx">defineProperty</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="p">{</span>
      <span class="nx">value</span><span class="o">:</span> <span class="nx">name</span><span class="p">,</span>
      <span class="nx">enumerable</span><span class="o">:</span> <span class="kc">true</span>
    <span class="p">});</span>
  <span class="p">}</span>
  <span class="k">else</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">name</span> <span class="o">=</span> <span class="nx">name</span><span class="p">;</span>
  <span class="p">}</span></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="game.description">
  <h3>
    <a href="#game.description" class="pilcrow">&#182;</a>
    Game.description
  </h3>
</div>

  </div>
  <div class="body"><p>A text describing the game</p>
  </div>
  <div class="details">
    <div class="dox_tag_title">API</div>
    <div class="dox_tag_detail">
      <span class="dox_type">private</span>
    </span>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>  <span class="nx">description</span> <span class="o">=</span> <span class="nx">settings</span><span class="p">.</span><span class="nx">description</span> <span class="o">||</span> <span class="s1">&#39;No Description&#39;</span><span class="p">;</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">node</span><span class="p">.</span><span class="nx">support</span><span class="p">.</span><span class="nx">defineProperty</span><span class="p">)</span> <span class="p">{</span>
    <span class="nb">Object</span><span class="p">.</span><span class="nx">defineProperty</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="s1">&#39;description&#39;</span><span class="p">,</span> <span class="p">{</span>
      <span class="nx">value</span><span class="o">:</span> <span class="nx">description</span><span class="p">,</span>
      <span class="nx">enumerable</span><span class="o">:</span> <span class="kc">true</span>
    <span class="p">});</span>
  <span class="p">}</span>
  <span class="k">else</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">description</span> <span class="o">=</span> <span class="nx">description</span><span class="p">;</span>
  <span class="p">}</span></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="game.gameloop">
  <h3>
    <a href="#game.gameloop" class="pilcrow">&#182;</a>
    Game.gameLoop
  </h3>
</div>

  </div>

<p><div class="body"><p>An object containing the game logic </p>
  </div>
  <div class="details">
    <div class="dox_tag_title">See</div>
    <div class="dox_tag_detail">
      <span class="dox_type">GameLoop</span>
    </div>
    <div class="dox_tag_title">API</div>
    <div class="dox_tag_detail">
      <span class="dox_type">private</span>
    </span>
  </div>
</div><!-- support for deprecated options loops --></p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>  <span class="nx">gameLoop</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">GameLoop</span><span class="p">(</span><span class="nx">settings</span><span class="p">.</span><span class="nx">loop</span> <span class="o">||</span> <span class="nx">settings</span><span class="p">.</span><span class="nx">loops</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">node</span><span class="p">.</span><span class="nx">support</span><span class="p">.</span><span class="nx">defineProperty</span><span class="p">)</span> <span class="p">{</span>
    <span class="nb">Object</span><span class="p">.</span><span class="nx">defineProperty</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="s1">&#39;gameLoop&#39;</span><span class="p">,</span> <span class="p">{</span>
      <span class="nx">value</span><span class="o">:</span> <span class="nx">gameLoop</span><span class="p">,</span>
      <span class="nx">enumerable</span><span class="o">:</span> <span class="kc">true</span>
    <span class="p">});</span>
  <span class="p">}</span>
  <span class="k">else</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">gameLoop</span> <span class="o">=</span> <span class="nx">gameLoop</span><span class="p">;</span>
  <span class="p">}</span>
  </pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="game.pl">
  <h3>
    <a href="#game.pl" class="pilcrow">&#182;</a>
    Game.pl
  </h3>
</div>

  </div>
  <div class="body"><p>The list of players connected to the game</p>

<p>The list may be empty, depending on the server settings</p>
  </div>
  <div class="details">
    <div class="dox_tag_title">API</div>
    <div class="dox_tag_detail">
      <span class="dox_type">private</span>
    </span>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>  <span class="nx">pl</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">PlayerList</span><span class="p">();</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">node</span><span class="p">.</span><span class="nx">support</span><span class="p">.</span><span class="nx">defineProperty</span><span class="p">)</span> <span class="p">{</span>
    <span class="nb">Object</span><span class="p">.</span><span class="nx">defineProperty</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="s1">&#39;pl&#39;</span><span class="p">,</span> <span class="p">{</span>
      <span class="nx">value</span><span class="o">:</span> <span class="nx">pl</span><span class="p">,</span>
      <span class="nx">enumerable</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
      <span class="nx">configurable</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
      <span class="nx">writable</span><span class="o">:</span> <span class="kc">true</span>
    <span class="p">});</span>
  <span class="p">}</span>
  <span class="k">else</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">pl</span> <span class="o">=</span> <span class="nx">pl</span><span class="p">;</span>
  <span class="p">}</span></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="game.pl">
  <h3>
    <a href="#game.pl" class="pilcrow">&#182;</a>
    Game.pl
  </h3>
</div>

  </div>
  <div class="body"><p>The list of monitor clients connected to the game</p>

<p>The list may be empty, depending on the server settings</p>
  </div>
  <div class="details">
    <div class="dox_tag_title">API</div>
    <div class="dox_tag_detail">
      <span class="dox_type">private</span>
    </span>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>  <span class="nx">ml</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">PlayerList</span><span class="p">();</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">node</span><span class="p">.</span><span class="nx">support</span><span class="p">.</span><span class="nx">defineProperty</span><span class="p">)</span> <span class="p">{</span>
    <span class="nb">Object</span><span class="p">.</span><span class="nx">defineProperty</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="s1">&#39;ml&#39;</span><span class="p">,</span> <span class="p">{</span>
      <span class="nx">value</span><span class="o">:</span> <span class="nx">ml</span><span class="p">,</span>
      <span class="nx">enumerable</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
      <span class="nx">configurable</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
      <span class="nx">writable</span><span class="o">:</span> <span class="kc">true</span>
    <span class="p">});</span>
  <span class="p">}</span>
  <span class="k">else</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">ml</span> <span class="o">=</span> <span class="nx">ml</span><span class="p">;</span>
  <span class="p">}</span>
  </pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="game.ready">
  <h3>
    <a href="#game.ready" class="pilcrow">&#182;</a>
    Game.ready
  </h3>
</div>

  </div>
  <div class="body"><p>If TRUE, the nodeGame engine is fully loaded</p>

<p>Shortcut to game.isReady</p>

<p>If the browser does not support the method object setters,
this property is disabled, and Game.isReady() should be used
instead.</p>
  </div>
  <div class="details">
    <div class="dox_tag_title">See</div>
    <div class="dox_tag_detail">
      <span class="dox_type">Game.isReady();</span>
    </div>
    <div class="dox_tag_title">API</div>
    <div class="dox_tag_detail">
      <span class="dox_type">private</span>
    </span>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>  <span class="k">if</span> <span class="p">(</span><span class="nx">node</span><span class="p">.</span><span class="nx">support</span><span class="p">.</span><span class="nx">getter</span><span class="p">)</span> <span class="p">{</span>
    <span class="nb">Object</span><span class="p">.</span><span class="nx">defineProperty</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="s1">&#39;ready&#39;</span><span class="p">,</span> <span class="p">{</span>
      <span class="nx">set</span><span class="o">:</span> <span class="kd">function</span><span class="p">(){},</span>
      <span class="nx">get</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">isReady</span><span class="p">,</span>
      <span class="nx">enumerable</span><span class="o">:</span> <span class="kc">true</span>
    <span class="p">});</span>
  <span class="p">}</span>
  <span class="k">else</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">ready</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
  <span class="p">}</span></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap" id="public-properties">
  <h2>
    <a href="#public-properties" class="pilcrow">&#182;</a>
    Public properties
  </h2>
</div>

        </td>
        <td class="code highlight"><div class="highlight"><pre></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="game.observer">
  <h3>
    <a href="#game.observer" class="pilcrow">&#182;</a>
    Game.observer
  </h3>
</div>

  </div>
  <div class="body"><p>If TRUE, silently observes the game. Defaults FALSE</p>

<p>An nodeGame observer will not send any automatic notification
to the server, but it will just <em>observe</em> the game played by
other clients.</p>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>  <span class="k">this</span><span class="p">.</span><span class="nx">observer</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;undefined&#39;</span> <span class="o">!==</span> <span class="k">typeof</span> <span class="nx">settings</span><span class="p">.</span><span class="nx">observer</span><span class="p">)</span> <span class="o">?</span> <span class="nx">settings</span><span class="p">.</span><span class="nx">observer</span> 
                                <span class="o">:</span> <span class="kc">false</span><span class="p">;</span></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="game.auto_step">
  <h3>
    <a href="#game.auto_step" class="pilcrow">&#182;</a>
    Game.auto_step
  </h3>
</div>

  </div>
  <div class="body"><p>If TRUE, automatically advances to the next state if all the players 
have completed the same state</p>

<p>After a successful STATEDONE event is fired, the client will automatically 
goes to the next function in the game-loop without waiting for a STATE
message from the server. </p>

<p>Depending on the configuration settings, it can still perform additional
checkings (e.g.wheter the mininum number of players is connected) 
before stepping to the next state.</p>

<p>Defaults: true</p>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>  <span class="k">this</span><span class="p">.</span><span class="nx">auto_step</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;undefined&#39;</span> <span class="o">!==</span> <span class="k">typeof</span> <span class="nx">settings</span><span class="p">.</span><span class="nx">auto_step</span><span class="p">)</span> <span class="o">?</span> <span class="nx">settings</span><span class="p">.</span><span class="nx">auto_step</span> 
                               <span class="o">:</span> <span class="kc">true</span><span class="p">;</span></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="game.auto_wait">
  <h3>
    <a href="#game.auto_wait" class="pilcrow">&#182;</a>
    Game.auto_wait
  </h3>
</div>

  </div>
  <div class="body"><p>If TRUE, fires a WAITING... event immediately after a successful DONE event</p>

<p>Under default settings, the WAITING... event temporarily prevents the user
to access the screen and displays a message to the player.</p>

<p>Defaults: FALSE</p>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>  <span class="k">this</span><span class="p">.</span><span class="nx">auto_wait</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;undefined&#39;</span> <span class="o">!==</span> <span class="k">typeof</span> <span class="nx">settings</span><span class="p">.</span><span class="nx">auto_wait</span><span class="p">)</span> <span class="o">?</span> <span class="nx">settings</span><span class="p">.</span><span class="nx">auto_wait</span> 
                                 <span class="o">:</span> <span class="kc">false</span><span class="p">;</span> </pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="game.solo_mode">
  <h3>
    <a href="#game.solo_mode" class="pilcrow">&#182;</a>
    Game.solo_mode
  </h3>
</div>

  </div>
  <div class="body"><p>If TRUE, automatically advances to the next state upon completion of a state</p>

<p>After a successful DONE event is fired, the client will automatically 
goes to the next function in the game-loop without waiting for a STATE
message from the server, or checking the STATE of the other players. </p>

<p>Defaults: FALSE</p>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>  <span class="k">this</span><span class="p">.</span><span class="nx">solo_mode</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;undefined&#39;</span> <span class="o">!==</span> <span class="k">typeof</span> <span class="nx">settings</span><span class="p">.</span><span class="nx">solo_mode</span><span class="p">)</span> <span class="o">?</span> <span class="nx">settings</span><span class="p">.</span><span class="nx">solo_mode</span> 
                               <span class="o">:</span> <span class="kc">false</span><span class="p">;</span> </pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-16" id="section-16">&#182;</a>
</div>
<p>TODO: check this</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>  <span class="k">this</span><span class="p">.</span><span class="nx">minPlayers</span> <span class="o">=</span> <span class="nx">settings</span><span class="p">.</span><span class="nx">minPlayers</span> <span class="o">||</span> <span class="mi">1</span><span class="p">;</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">maxPlayers</span> <span class="o">=</span> <span class="nx">settings</span><span class="p">.</span><span class="nx">maxPlayers</span> <span class="o">||</span> <span class="mi">1000</span><span class="p">;</span>
  
  <span class="k">if</span> <span class="p">(</span><span class="nx">settings</span><span class="p">.</span><span class="nx">init</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">init</span> <span class="o">=</span> <span class="nx">settings</span><span class="p">.</span><span class="nx">init</span><span class="p">;</span>
  <span class="p">}</span></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="game.memory">
  <h3>
    <a href="#game.memory" class="pilcrow">&#182;</a>
    Game.memory
  </h3>
</div>

  </div>
  <div class="body"><p>A storage database for the game</p>

<p>In the server logic the content of SET messages are
automatically inserted in this object</p>


<div class="highlight"><pre><code><span class="nv">@see</span> <span class="n">node</span><span class="o">.</span><span class="n">set</span>
</code></pre></div>


  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>  <span class="k">this</span><span class="p">.</span><span class="nx">memory</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">GameDB</span><span class="p">();</span>
  
  <span class="k">this</span><span class="p">.</span><span class="nx">player</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span> 
  <span class="k">this</span><span class="p">.</span><span class="nx">state</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">GameState</span><span class="p">();</span>

<span class="p">}</span> <span class="c1">// &lt;!-- ends constructor --&gt;</span></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap" id="game-methods">
  <h2>
    <a href="#game-methods" class="pilcrow">&#182;</a>
    Game methods
  </h2>
</div>

        </td>
        <td class="code highlight"><div class="highlight"><pre></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="game.init">
  <h3>
    <a href="#game.init" class="pilcrow">&#182;</a>
    Game.init
  </h3>
</div>

  </div>
  <div class="body"><p>Initialization function</p>

<p>This function is called as soon as the game is instantiated,
i.e. at state 0.0.0. All event listeners declared here will
stay valid throughout the game.</p>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre><span class="nx">Game</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">init</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{};</span></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="game.pause">
  <h3>
    <a href="#game.pause" class="pilcrow">&#182;</a>
    Game.pause
  </h3>
</div>

  </div>
  <div class="body"><p>Experimental. Sets the game to pause</p>
  </div>
  <div class="details">
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre><span class="nx">Game</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">pause</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">paused</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
<span class="p">};</span></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="game.resume">
  <h3>
    <a href="#game.resume" class="pilcrow">&#182;</a>
    Game.resume
  </h3>
</div>

  </div>
  <div class="body"><p>Experimental. Resumes the game from a pause</p>
  </div>
  <div class="details">
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre><span class="nx">Game</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">resume</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">paused</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
<span class="p">};</span></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="game.next">
  <h3>
    <a href="#game.next" class="pilcrow">&#182;</a>
    Game.next
  </h3>
</div>

  </div>
  <div class="body"><p>Fetches a state from the game-loop N steps ahead</p>

<p>Optionally, a parameter can control the number of steps to take
in the game-loop before returning the state</p>
  </div>
  <div class="details">
    <div class="dox_tag_title">Params</div>
    <div class="dox_tag_detail">
      <span>N</span>
      <span class="dox_type">number</span>
      <span>Optional. The number of steps to take in the game-loop. Defaults 1</span>
    </div>
    <div class="dox_tag_title">Returns</div>
    <div class="dox_tag_detail">
      <span></span>
      <span class="dox_type">boolean</span>
      <span class="dox_type">GameState</span>
      <span>The next state, or FALSE if it does not exist</span>
    </div>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre><span class="nx">Game</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">next</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">N</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">N</span><span class="p">)</span> <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">gameLoop</span><span class="p">.</span><span class="nx">next</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">);</span>
  <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">gameLoop</span><span class="p">.</span><span class="nx">jumpTo</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">,</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">abs</span><span class="p">(</span><span class="nx">N</span><span class="p">));</span>
<span class="p">};</span></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="game.previous">
  <h3>
    <a href="#game.previous" class="pilcrow">&#182;</a>
    Game.previous
  </h3>
</div>

  </div>
  <div class="body"><p>Fetches a state from the game-loop N steps back</p>

<p>Optionally, a parameter can control the number of steps to take
backward in the game-loop before returning the state</p>
  </div>
  <div class="details">
    <div class="dox_tag_title">Params</div>
    <div class="dox_tag_detail">
      <span>times</span>
      <span class="dox_type">number</span>
      <span>Optional. The number of steps to take in the game-loop. Defaults 1</span>
    </div>
    <div class="dox_tag_title">Returns</div>
    <div class="dox_tag_detail">
      <span></span>
      <span class="dox_type">boolean</span>
      <span class="dox_type">GameState</span>
      <span>The previous state, or FALSE if it does not exist</span>
    </div>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre><span class="nx">Game</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">previous</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">N</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">N</span><span class="p">)</span> <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">gameLoop</span><span class="p">.</span><span class="nx">previous</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">);</span>
  <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">gameLoop</span><span class="p">.</span><span class="nx">jumpTo</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">,</span> <span class="o">-</span><span class="nb">Math</span><span class="p">.</span><span class="nx">abs</span><span class="p">(</span><span class="nx">N</span><span class="p">));</span>
<span class="p">};</span></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="game.jumpto">
  <h3>
    <a href="#game.jumpto" class="pilcrow">&#182;</a>
    Game.jumpTo
  </h3>
</div>

  </div>
  <div class="body"><p>Moves the game forward or backward in the game-loop</p>

<p>Optionally, a parameter can control the number of steps to take
in the game-loop before executing the next function. A negative 
value jumps backward in the game-loop, and a positive one jumps
forward in the game-loop</p>
  </div>
  <div class="details">
    <div class="dox_tag_title">Params</div>
    <div class="dox_tag_detail">
      <span>jump</span>
      <span class="dox_type">number</span>
      <span>The number of steps to take in the game-loop</span>
    </div>
    <div class="dox_tag_title">Returns</div>
    <div class="dox_tag_detail">
      <span></span>
      <span class="dox_type">boolean</span>
      <span>TRUE, if the game succesfully jumped to the desired state</span>
    </div>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre><span class="nx">Game</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">jumpTo</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">jump</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">jump</span><span class="p">)</span> <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
  <span class="kd">var</span> <span class="nx">gs</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">gameLoop</span><span class="p">.</span><span class="nx">jumpTo</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">,</span> <span class="nx">jump</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">gs</span><span class="p">)</span> <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
  <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">updateState</span><span class="p">(</span><span class="nx">gs</span><span class="p">);</span>
<span class="p">};</span></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="game.publishstate">
  <h3>
    <a href="#game.publishstate" class="pilcrow">&#182;</a>
    Game.publishState
  </h3>
</div>

  </div>
  <div class="body"><p>Notifies internal listeners, the server and other connected clients 
of the current game-state</p>

<p>If the <em>observer</em> flag is set, external notification is inhibited, 
but the STATECHANGE event is emitted anyway </p>
  </div>
  <div class="details">
    <div class="dox_tag_title">See</div>
    <div class="dox_tag_detail">
      <span class="dox_type">GameState</span>
    </div>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre><span class="nx">Game</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">publishState</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-26" id="section-26">&#182;</a>
</div>
<!-- Important: SAY -->
        </td>
        <td class="code highlight"><div class="highlight"><pre>  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">observer</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">stateEvent</span> <span class="o">=</span> <span class="nx">GameMsg</span><span class="p">.</span><span class="nx">OUT</span> <span class="o">+</span> <span class="nx">GameMsg</span><span class="p">.</span><span class="nx">actions</span><span class="p">.</span><span class="nx">SAY</span> <span class="o">+</span> <span class="s1">&#39;.STATE&#39;</span><span class="p">;</span> 
    <span class="nx">node</span><span class="p">.</span><span class="nx">emit</span><span class="p">(</span><span class="nx">stateEvent</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">,</span> <span class="s1">&#39;ALL&#39;</span><span class="p">);</span>
  <span class="p">}</span>
  
  <span class="nx">node</span><span class="p">.</span><span class="nx">emit</span><span class="p">(</span><span class="s1">&#39;STATECHANGE&#39;</span><span class="p">);</span>
  
  <span class="nx">node</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;New State = &#39;</span> <span class="o">+</span> <span class="k">new</span> <span class="nx">GameState</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">),</span> <span class="s1">&#39;DEBUG&#39;</span><span class="p">);</span>
<span class="p">};</span></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="game.updatestate">
  <h3>
    <a href="#game.updatestate" class="pilcrow">&#182;</a>
    Game.updateState
  </h3>
</div>

  </div>
  <div class="body"><p>Updates the game to the specified game-state</p>
  </div>
  <div class="details">
    <div class="dox_tag_title">Params</div>
    <div class="dox_tag_detail">
      <span>state</span>
      <span class="dox_type">GameState</span>
      <span>The state to load and run</span>
    </div>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre><span class="nx">Game</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">updateState</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">state</span><span class="p">)</span> <span class="p">{</span>
  
  <span class="nx">node</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;New state is going to be &#39;</span> <span class="o">+</span> <span class="k">new</span> <span class="nx">GameState</span><span class="p">(</span><span class="nx">state</span><span class="p">),</span> <span class="s1">&#39;DEBUG&#39;</span><span class="p">);</span>
  
  <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">step</span><span class="p">(</span><span class="nx">state</span><span class="p">)</span> <span class="o">!==</span> <span class="kc">false</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">paused</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">is</span> <span class="o">=</span>  <span class="nx">GameState</span><span class="p">.</span><span class="nx">iss</span><span class="p">.</span><span class="nx">LOADED</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">isReady</span><span class="p">())</span> <span class="p">{</span>
      <span class="nx">node</span><span class="p">.</span><span class="nx">emit</span><span class="p">(</span><span class="s1">&#39;LOADED&#39;</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">}</span>   
  <span class="k">else</span> <span class="p">{</span>
    <span class="nx">node</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;Error in stepping&#39;</span><span class="p">,</span> <span class="s1">&#39;ERR&#39;</span><span class="p">);</span></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-28" id="section-28">&#182;</a>
</div>
<p>TODO: implement sendERR</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>    <span class="nx">node</span><span class="p">.</span><span class="nx">emit</span><span class="p">(</span><span class="s1">&#39;TXT&#39;</span><span class="p">,</span><span class="s1">&#39;State was not updated&#39;</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">};</span></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="game.step">
  <h3>
    <a href="#game.step" class="pilcrow">&#182;</a>
    Game.step
  </h3>
</div>

  </div>
  <div class="body"><p>Retrieves from the game-loop and executes the function for the 
specified game-state</p>
  </div>
  <div class="details">
    <div class="dox_tag_title">Params</div>
    <div class="dox_tag_detail">
      <span>gameState</span>
      <span class="dox_type">GameState</span>
      <span>Optional. The GameState to run</span>
    </div>
    <div class="dox_tag_title">Returns</div>
    <div class="dox_tag_detail">
      <span></span>
      <span class="dox_type">Boolean</span>
      <span>FALSE, if the execution encountered an error</span>
    </div>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre><span class="nx">Game</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">step</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">gameState</span><span class="p">)</span> <span class="p">{</span>
  
  <span class="nx">gameState</span> <span class="o">=</span> <span class="nx">gameState</span> <span class="o">||</span> <span class="k">this</span><span class="p">.</span><span class="nx">next</span><span class="p">();</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">gameState</span><span class="p">)</span> <span class="p">{</span>
    
    <span class="kd">var</span> <span class="nx">func</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">gameLoop</span><span class="p">.</span><span class="nx">getFunction</span><span class="p">(</span><span class="nx">gameState</span><span class="p">);</span>
    </pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-30" id="section-30">&#182;</a>
</div>
<p>Experimental: node.window should load the func as well
        if (node.window) {
            var frame = this.gameLoop.getAllParams(gameState).frame;
            node.window.loadFrame(frame);
        }</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>    
    
    
    <span class="k">if</span> <span class="p">(</span><span class="nx">func</span><span class="p">)</span> <span class="p">{</span></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-31" id="section-31">&#182;</a>
</div>
<p>Local Listeners from previous state are erased 
before proceeding to next one</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>      <span class="nx">node</span><span class="p">.</span><span class="nx">events</span><span class="p">.</span><span class="nx">clearState</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">);</span>
      
      <span class="nx">gameState</span><span class="p">.</span><span class="nx">is</span> <span class="o">=</span> <span class="nx">GameState</span><span class="p">.</span><span class="nx">iss</span><span class="p">.</span><span class="nx">LOADING</span><span class="p">;</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">state</span> <span class="o">=</span> <span class="nx">gameState</span><span class="p">;</span>
    </pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-32" id="section-32">&#182;</a>
</div>
<p>This could speed up the loading in other client,
but now causes problems of multiple update</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>      <span class="k">this</span><span class="p">.</span><span class="nx">publishState</span><span class="p">();</span>
          
      <span class="k">return</span> <span class="nx">func</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">node</span><span class="p">.</span><span class="nx">game</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
<span class="p">};</span></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="game.isready">
  <h3>
    <a href="#game.isready" class="pilcrow">&#182;</a>
    Game.isReady
  </h3>
</div>

  </div>
  <div class="body"><p>Returns TRUE if the nodeGame engine is fully loaded</p>

<p>During stepping between functions in the game-loop
the flag is temporarily turned to FALSE, and all events 
are queued and fired only after nodeGame is ready to 
handle them again.</p>

<p>If the browser does not support the method object setters,
this property is disabled, and Game.isReady() should be used
instead.</p>
  </div>
  <div class="details">
    <div class="dox_tag_title">See</div>
    <div class="dox_tag_detail">
      <span class="dox_type">Game.ready;</span>
    </div>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre><span class="nx">Game</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">isReady</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">is</span> <span class="o">&lt;</span> <span class="nx">GameState</span><span class="p">.</span><span class="nx">iss</span><span class="p">.</span><span class="nx">LOADED</span><span class="p">)</span> <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
  </pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-34" id="section-34">&#182;</a>
</div>
<p>Check if there is a gameWindow obj and whether it is loading</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>  <span class="k">if</span> <span class="p">(</span><span class="nx">node</span><span class="p">.</span><span class="nb">window</span><span class="p">)</span> <span class="p">{</span>  
    <span class="k">return</span> <span class="p">(</span><span class="nx">node</span><span class="p">.</span><span class="nb">window</span><span class="p">.</span><span class="nx">state</span> <span class="o">&gt;=</span> <span class="nx">GameState</span><span class="p">.</span><span class="nx">iss</span><span class="p">.</span><span class="nx">LOADED</span><span class="p">)</span> <span class="o">?</span> <span class="kc">true</span> <span class="o">:</span> <span class="kc">false</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
<span class="p">};</span></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap" id="closure">
  <h2>
    <a href="#closure" class="pilcrow">&#182;</a>
    Closure
  </h2>
</div>

        </td>
        <td class="code highlight"><div class="highlight"><pre><span class="p">})(</span>
  <span class="s1">&#39;undefined&#39;</span> <span class="o">!=</span> <span class="k">typeof</span> <span class="nx">node</span> <span class="o">?</span> <span class="nx">node</span> <span class="o">:</span> <span class="nx">module</span><span class="p">.</span><span class="nx">exports</span>
  <span class="p">,</span> <span class="s1">&#39;undefined&#39;</span> <span class="o">!=</span> <span class="k">typeof</span> <span class="nx">node</span> <span class="o">?</span> <span class="nx">node</span> <span class="o">:</span> <span class="nx">module</span><span class="p">.</span><span class="nx">parent</span><span class="p">.</span><span class="nx">exports</span>
<span class="p">);</span>
</pre></div>
        </td>
      </tr>
  </tbody>
</table>
  </div>
</body>
</html>
